{"version":3,"sources":["utilities.js","libraries.js","main.js"],"names":["utils","$modal","root","$","dialog","title","btn","closeBtn","body","footer","data","action","show","shown","hidden","loading","a","arguments","length","undefined","unsetError","html","prop","error","unsetLoadingState","hide","concat","slideDown","modal","on","e","tooltip","fn","selectpicker","find","scrollbar","_ref","_ref$title","_ref$btnLabel","btnLabel","_ref$btnClass","btnClass","_ref$btnDisabled","btnDisabled","_ref$btnCloseLabel","btnCloseLabel","_ref$btnCloseClass","btnCloseClass","_ref$data","_ref$dialogClass","dialogClass","_ref$backdrop","backdrop","_ref$action","_ref$show","_ref$shown","_ref$hidden","onclick","attr","addClass","_config","trigger","getModalData","doModalAction","modalLoading","modalError","notif","message","type","settings","options","notifyClose","icon","notify","_objectSpread","getSlug","text","toLowerCase","replace","dbg","c","DEV","console","info","log","split","selector","notifyDefaults","placement","from","animate","enter","exit","extend","dataTable","defaults","dom","language","decimal","thousands","lengthMenu","search","infoFiltered","infoEmpty","paginate","previous","next","zeroRecords","emptyTable","pageLength","$tbl","$$","sectionInput","sectionResult","dropzone","tbl","change","readFile","target","files","click","fadeIn","checkIfDone","n","i","nValid","generateResult","nInvalid","nFailed","readCsv","filename","startsWith","push","csv","toObjects","err","Array","forEach","file","ext","name","substr","lastIndexOf","reader","FileReader","readAsText","innerFiles","resetDisplay","timezone","Number","val","merged","employees","b","time","m","format","includes","id_employee","findIndex","id_employee_d","id_employee_t","dt_day","allTime","range_photo","PhotoQuestionTitle","dt_range_time","dt_time","range_time","range_coordinate","range_location","range_note","NotesQuestionTitle","map","sort","join","timeChoice","this","DataTable","columns","className","render","_ref3","tblFilter","draw","display","exportExcel","sheets","wb","XLSX","book_new","header","rawdata","rows","toArray","dataByEmployee","day","JSZip","document","zip"],"mappings":"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","file":"main.js","sourcesContent":["const utils = (function() {\r\n\r\n\tlet $modal = {\r\n\t\troot: $('#modal'),\r\n\t\tdialog: $('#modal-dialog'),\r\n\t\ttitle: $('#modal-title'),\r\n\t\tbtn: '',\r\n\t\tcloseBtn: $('#modal-title + .close'),\r\n\t\tbody: $('#modal-body'),\r\n\t\tfooter: $('#modal-footer'),\r\n\t\tdata: {},\r\n\t\taction: () => {},\r\n\t\tshow: () => {},\r\n\t\tshown: () => {},\r\n\t\thidden: () => {},\r\n\t\tloading: (a='<i class=\"fas fa-sync fa-spin mr-2\"></i>Memproses...', unsetError=true) => {\r\n\t\t\tif (a === false) {\r\n\t\t\t\t$('#modal-btn').html($modal.btn).prop('disabled', false);\r\n\t\t\t\t$('[data-dismiss=\"modal\"]').prop('disabled', false);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$('#modal-btn').html(a).prop('disabled', true);\r\n\t\t\t\t$('[data-dismiss=\"modal\"]').prop('disabled', true);\r\n\t\t\t\tif (unsetError) $modal.error(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: (a=false, unsetLoadingState=true) => {\r\n\t\t\tif (a === false) $('#modal-error').hide();\r\n\t\t\telse {\r\n\t\t\t\t$('#modal-error').html(`<div class=\"px-3 py-2\"><i class=\"fas fa-exclamation-triangle mr-2\"></i>${a}</div>`).slideDown();\r\n\t\t\t\tif (unsetLoadingState) $modal.loading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n\r\n\tconst modal = ({ title='', body, btnLabel='Ok', btnClass='btn-primary', btnDisabled=false, btnCloseLabel='Batal', btnCloseClass='btn-default', data={}, dialogClass='', backdrop=true, action=null, show=null, shown=null, hidden=null }) => {\r\n\r\n\t\t$modal.data = data;\r\n\t\t$modal.btn = btnLabel;\r\n\t\t$modal.action = typeof action === 'function' ? action : (() => {});\r\n\t\t$modal.show = typeof show === 'function' ? show : (() => {});\r\n\t\t$modal.shown = typeof shown === 'function' ? shown : (() => {});\r\n\t\t$modal.hidden = typeof hidden === 'function' ? hidden : (() => {});\r\n\r\n\t\tlet onclick = 'data-dismiss=\"modal\"';\r\n\t\tif (typeof action === 'string') onclick = `onclick=\"${action}\"`;\r\n\t\telse if (typeof action === 'function') onclick = 'onclick=\"utils.doModalAction()\"';\r\n\r\n\t\t$modal.dialog.attr('class', 'modal-dialog').addClass(dialogClass);\r\n\t\t$modal.title.html(title);\r\n\t\t$modal.body.html(body);\r\n\t\t$modal.footer.html(`\r\n\t\t\t<button type=\"button\" class=\"btn ${btnCloseClass}\" data-dismiss=\"modal\">${btnCloseLabel}</button>\r\n\t\t\t<button type=\"button\" id=\"modal-btn\" ${onclick} class=\"btn ${btnClass}\" ${btnDisabled ? 'disabled' : ''}>${btnLabel}</button>\r\n\t\t`);\r\n\r\n\t\t$modal.root.data('bs.modal')._config.backdrop = backdrop;\r\n\r\n\t\t$modal.error();\r\n\r\n\t\treturn $modal.root.modal('show').trigger('show.bs.modal');\r\n\t};\r\n\r\n\t$modal.root\r\n\t.modal('hide')\r\n\t.on('show.bs.modal', e => {\r\n\t\t$modal.closeBtn.prop('disabled', false);\r\n\t\t$('[data-toggle=\"tooltip\"]').tooltip('hide');\r\n\t\tif ($.fn.selectpicker) $modal.root.find('.selectpicker').selectpicker('render');\r\n\t\tif ($.fn.scrollbar) $modal.root.find('.scrollbar-outer').scrollbar();\r\n\t\t$modal.show();\r\n\t})\r\n\t.on('shown.bs.modal', e => {\r\n\t\t$modal.shown();\r\n\t})\r\n\t.on('hidden.bs.modal', e => {\r\n\t\t$modal.hidden();\r\n\t});\r\n\r\n\tconst notif = (message, type='info', close=false, settings, options) => {\r\n\t\tif (close) $.notifyClose();\r\n\t\tlet icon = 'icon-info';\r\n\t\tif (type === 'wait') { icon = 'icon-hourglass'; type = 'info'; }\r\n\t\tif (type === 'success') { icon = 'icon-check'; }\r\n\t\tif (type === 'danger' || type === 'warning') { icon = 'icon-exclamation'; }\r\n\t\t$.notify({ message, icon, ...options }, { type, ...settings });\r\n\t}\r\n\r\n\tconst getSlug = text=> text.toLowerCase().replace(/[^\\w ]+/g,'').replace(/ +/g,'-');\r\n\r\n\treturn {\r\n\t\tmodal,\r\n\t\tgetModalData: () => $modal.data,\r\n\t\tdoModalAction: () => $modal.action(),\r\n\t\tmodalLoading: $modal.loading,\r\n\t\tmodalError: $modal.error,\r\n\t\tnotif,\r\n\t\tgetSlug,\r\n\t}\r\n\r\n})();\r\n\r\n\r\n\r\nconst dbg = (a='!', c=0) => {\r\n\tif (typeof DEV !== 'undefined') {\r\n\t\tif (DEV) console.info('%c'+a, `color: ${typeof c==='number'? ['#00ff7f', '#6495ed', '#ff0', '#fa8072', '#ffa500', '#f00'][c] : c}`);\r\n\t}\r\n}\r\n\r\n\r\n\r\n$(()=>{\r\n\r\n\tconsole.log('Â© Muhammad Afifudin, 2020');\r\n\tconsole.log('%cVersion: '+$('script[src*=\"assets/js\"]').prop('src').split('?v=')[1], 'color: #6495ed');\r\n\r\n\t$('body').tooltip({ selector: '[data-toggle=\"tooltip\"]', html: true });\r\n\r\n});\r\n","$.notifyDefaults({\r\n\tplacement: { from: 'bottom' },\r\n\tanimate: { enter: 'animated fadeInUp', exit: 'animated fadeOutDown' },\r\n});\r\n\r\n$.extend(true, $.fn.dataTable.defaults, {\r\n\tdom: \"<'row justify-content-center'<'col-sm-auto'l><'col-sm'f>>r<'table-responsive't><'row justify-content-center align-items-center'<'col-sm-auto'i><'col-sm'p>>\",\r\n\tlanguage: {\r\n\t\tdecimal: ',',\r\n\t\tthousands: '.',\r\n\t\tlengthMenu: 'Menampilkan &nbsp;_MENU_&nbsp; data',\r\n\t\tsearch: 'Cari',\r\n\t\tinfo: 'Halaman _PAGE_ dari _PAGES_',\r\n\t\tinfoFiltered: '',\r\n\t\tinfoEmpty: 'Menampilkan 0 hasil',\r\n\t\tpaginate: { previous: '<i class=\"fas fa-chevron-left\"></i>', next: '<i class=\"fas fa-chevron-right\"></i>' },\r\n\t\tzeroRecords: 'Tidak ada hasil',\r\n\t\temptyTable: 'Tidak ada data',\r\n\t},\r\n\tpageLength: 50,\r\n\tlengthMenu: [10, 25, 50, 100, 250, 500],\r\n});\r\n","$(() => {\r\n\r\n\tconst $$ = {\r\n\t\tsectionInput: $('#section-input'),\r\n\t\tsectionResult: $('#section-result'),\r\n\t\tdropzone: $('#dropzone'),\r\n\t\ttbl: $('#table'),\r\n\t};\r\n\r\n\tvar $tbl,\r\n\t\tdata = [],\r\n\t\ttimezone = 7,\r\n\t\tdisplay = 0,\r\n\t\ttimeChoice = $('[name=\"time_setting\"]:checked').val(),\r\n\t\temployees,\r\n\t\tsectionResult = false;\r\n\r\n\t$$.dropzone\r\n\t\t.on('click', function (e) { $('#input-files').trigger('click') })\r\n\t\t.on('drag dragstart dragend dragover dragenter dragleave drop', function (e) { e.preventDefault(); e.stopPropagation(); })\r\n\t\t.on('dragover dragenter', function () { $$.dropzone.addClass('dragover') })\r\n\t\t.on('dragleave dragend drop', function () { $$.dropzone.removeClass('dragover') })\r\n\t\t.on('drop', function (e) { readFile(e.originalEvent.dataTransfer.files) });\r\n\r\n\t$('#input-files').change(function (e) { readFile(e.target.files) });\r\n\r\n\t$('#btn-reset').click(function () {\r\n\t\t$('.tooltip').tooltip('hide');\r\n\t\t$$.sectionResult.hide(); sectionResult = false;\r\n\t\t$$.sectionInput.fadeIn();\r\n\t});\r\n\r\n\tconst readFile = files => {\r\n\r\n\t\tdata = [];\r\n\t\tlet i = 0,\r\n\t\t\tn = files.length,\r\n\t\t\tnValid = 0,\r\n\t\t\tnInvalid = 0,\r\n\t\t\tnFailed = 0;\r\n\r\n\t\tconst checkIfDone = () => {\r\n\t\t\tif (n === i) {\r\n\t\t\t\tif (nValid) {\r\n\t\t\t\t\tutils.notif(nValid + ' file berhasil diproses', 'success');\r\n\t\t\t\t\tgenerateResult();\r\n\t\t\t\t}\r\n\t\t\t\tif (nInvalid) utils.notif((nValid ? nInvalid + ' file' : 'File') + ' tidak valid', 'danger');\r\n\t\t\t\tif (nFailed) utils.notif(nFailed + ' file gagal terbaca', 'warning');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst readCsv = (filename, text) => {\r\n\t\t\tif (text.replace(/\\\"/g, '').startsWith('Responder Name,Group Name,')) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\tfilename: filename,\r\n\t\t\t\t\t\tdata: $.csv.toObjects(text.replace(/\\,\\=\\\"20/g, ',\"20')),\r\n\t\t\t\t\t});\r\n\t\t\t\t\ti++; nValid++; checkIfDone();\r\n\t\t\t\t}\r\n\t\t\t\tcatch (err) {\r\n\t\t\t\t\ti++; nFailed++; checkIfDone();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse { i++; nInvalid++; checkIfDone(); }\r\n\t\t}\r\n\r\n\t\tArray.from(files).forEach(file => {\r\n\t\t\tlet ext = file.name.substr(file.name.lastIndexOf('.') + 1).toLowerCase();\r\n\t\t\tif (ext === 'csv') {\r\n\t\t\t\tlet reader = new FileReader();\r\n\t\t\t\treader.readAsText(file);\r\n\t\t\t\treader.onload = function (e) { readCsv(file.name, e.target.result.replace(/\\t/g, ',')); }\r\n\t\t\t\treader.onerror = function () { i++; nFailed++; checkIfDone(); }\r\n\t\t\t}\r\n\t\t\telse if (ext === 'zip') {\r\n\t\t\t\tJSZip.loadAsync(file).then(function (zip) {\r\n\t\t\t\t\tlet innerFiles = Object.keys(zip.files);\r\n\t\t\t\t\ti -= innerFiles.length - 1;\r\n\t\t\t\t\tinnerFiles.forEach(function (filename) {\r\n\t\t\t\t\t\tif (filename.substr(filename.lastIndexOf('.') + 1).toLowerCase() === 'csv') {\r\n\t\t\t\t\t\t\tzip.files[filename].async('string').then(function (text) {\r\n\t\t\t\t\t\t\t\treadCsv(filename, text.replace(/\\t/g, ',').replace(/\\ufeff/g, ''));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse { i++; nInvalid++; checkIfDone(); }\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function (e) {\r\n\t\t\t\t\ti++; nFailed++; checkIfDone();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse { i++; nInvalid++; }\r\n\t\t});\r\n\r\n\t\tcheckIfDone();\r\n\t}\r\n\r\n\tconst generateResult = (resetDisplay = true) => {\r\n\r\n\t\tconsole.info(data);\r\n\r\n\t\tconst colorTime = (m, n) => `<span class=\"text-${n <= 73000 || n >= (m.format('e') === '4' ? 163000 : 160000) ? 'green' : 'danger'}\">${m.format('HH:mm:ss')}</span>`;\r\n\r\n\t\ttimezone = Number($('#select-timezone').val());\r\n\r\n\t\tlet merged = []; employees = [];\r\n\r\n\t\tdata.forEach(a => {\r\n\t\t\ta.data.forEach(b => {\r\n\r\n\t\t\t\tlet m = moment(b[timeChoice].substr(0, 19)).add(timezone, 'hours'),\r\n\t\t\t\t\tday = m.format('dddd,D MMMM YYYY').split(','),\r\n\t\t\t\t\ttime = [m.format('HH:mm:ss'), Number(m.format('HHmmss'))];\r\n\r\n\t\t\t\tif (!employees.includes(b['Responder Name'])) employees.push(b['Responder Name']);\r\n\r\n\t\t\t\tlet id_employee = employees.findIndex(c => c === b['Responder Name']) + 1,\r\n\t\t\t\t\tid_employee_d = id_employee + m.format('-YYYYMMDD'),\r\n\t\t\t\t\tid_employee_t = id_employee + m.format('-YYYYMMDD-HHmmss');\r\n\r\n\t\t\t\tmerged.push({\r\n\t\t\t\t\t...b,\r\n\t\t\t\t\tm,\r\n\t\t\t\t\tday,\r\n\t\t\t\t\ttime,\r\n\t\t\t\t\tdt_day: m.format('[<span class=\"d-none\">]YYYYMMDD[</span>]dddd, D MMMM YYYY'),\r\n\t\t\t\t\tdt_time: colorTime(m, time[1]),\r\n\t\t\t\t\tid_employee,\r\n\t\t\t\t\tid_employee_d,\r\n\t\t\t\t\tid_employee_t,\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tmerged.forEach(a => {\r\n\t\t\tlet allTime = merged.filter(b => b.id_employee_d === a.id_employee_d).sort((a, b) => a.time[1] > b.time[1] ? 1 : -1),\r\n\t\t\t\tn = allTime.length,\r\n\t\t\t\tthisTimeIndex = allTime.findIndex(b => b.time[0] === a.time[0]);\r\n\t\t\tif (thisTimeIndex === 0) {\r\n\t\t\t\tif (n === 1) {\r\n\t\t\t\t\tif (a.time[1] < 120000) {\r\n\t\t\t\t\t\ta.range_time = [a.time[0], '-'];\r\n\t\t\t\t\t\ta.range_coordinate = [a['Responder Location Latitude'] + ', ' + a['Responder Location Longitude'], '-'];\r\n\t\t\t\t\t\ta.range_location = [a['Responder Location Location'], '-'];\r\n\t\t\t\t\t\ta.range_note = [a.NotesQuestionTitle, '-'];\r\n\t\t\t\t\t\ta.range_photo = [a.PhotoQuestionTitle, '-'];\r\n\t\t\t\t\t\ta.dt_range_time = [a.dt_time, '<span class=\"text-gray\">-</span>'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ta.range_time = ['-', a.time[0]];\r\n\t\t\t\t\t\ta.range_coordinate = ['-', a['Responder Location Latitude'] + ', ' + a['Responder Location Longitude']];\r\n\t\t\t\t\t\ta.range_location = ['-', a['Responder Location Location']];\r\n\t\t\t\t\t\ta.range_note = ['-', a.NotesQuestionTitle];\r\n\t\t\t\t\t\ta.range_photo = ['-', a.PhotoQuestionTitle];\r\n\t\t\t\t\t\ta.dt_range_time = ['<span class=\"text-gray\">-</span>', a.dt_time];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet b = allTime[n - 1];\r\n\t\t\t\t\ta.range_time = [a.time[0], b.time[0]];\r\n\t\t\t\t\ta.range_coordinate = [a['Responder Location Latitude'] + ', ' + a['Responder Location Longitude'], b['Responder Location Latitude'] + ', ' + b['Responder Location Longitude']];\r\n\t\t\t\t\ta.range_location = [a['Responder Location Location'], b['Responder Location Location']];\r\n\t\t\t\t\ta.range_note = [a.NotesQuestionTitle, b.NotesQuestionTitle];\r\n\t\t\t\t\ta.range_photo = [a.PhotoQuestionTitle, b.PhotoQuestionTitle];\r\n\t\t\t\t\ta.dt_range_time = [a.dt_time, b.dt_time];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$tbl.clear().rows.add(merged).draw();\r\n\t\t$$.tblFilter.html(\r\n\t\t\t'<option value=\"\">Semua Pegawai</option><option style=\"border-bottom: 1px solid #eee; font-size: 0; padding: 6px 0 0; margin-bottom: 6px;\" disabled></option>'\r\n\t\t\t+ employees.map((a, i) => [a, `<option value=\"${i + 1}\">${a}</option>`]).sort((a, b) => a[0] > b[0] ? 1 : -1).map(a => a[1]).join('')\r\n\t\t).trigger('change').selectpicker('refresh');\r\n\r\n\t\tif (resetDisplay) {\r\n\t\t\t$('#display_setting1').click();\r\n\t\t\t$('#select-timezone-2').selectpicker('val', timezone);\r\n\t\t\t$$.sectionInput.hide();\r\n\t\t\t$$.sectionResult.fadeIn(); sectionResult = true;\r\n\t\t}\r\n\t}\r\n\r\n\t$('[name=\"display_setting\"]').change(function () {\r\n\t\tdisplay = Number($(this).val());\r\n\t\t$$.tbl.toggleClass('td3-d-none td6-d-none', display === 0).toggleClass('td4-d-none td5-d-none', display === 1);\r\n\t\t$tbl.draw();\r\n\t});\r\n\r\n\t$('[name=\"time_setting\"]').change(function () {\r\n\t\ttimeChoice = $(this).val();\r\n\t\tgenerateResult(false);\r\n\t});\r\n\r\n\t$('#select-timezone-2').change(function () {\r\n\t\tdbg('Changed - ' + sectionResult);\r\n\t\tif (sectionResult) {\r\n\t\t\t$('#select-timezone').selectpicker('val', $('#select-timezone-2').val());\r\n\t\t\tgenerateResult(false);\r\n\t\t}\r\n\t});\r\n\r\n\t$tbl = $$.tbl.DataTable({\r\n\t\tdata: [],\r\n\t\tcolumns: [{\r\n\t\t\tclassName: 'fit',\r\n\t\t\ttitle: 'Hari, Tanggal',\r\n\t\t\tdata: 'dt_day',\r\n\t\t}, {\r\n\t\t\ttitle: 'Nama',\r\n\t\t\tdata: null,\r\n\t\t\trender: a => `<span class=\"d-none\">[id=${a.id_employee}]</span>${a['Responder Name']}`,\r\n\t\t}, {\r\n\t\t\ttitle: 'Waktu',\r\n\t\t\tdata: 'dt_time',\r\n\t\t}, {\r\n\t\t\ttitle: 'Waktu Mulai',\r\n\t\t\tdata: null,\r\n\t\t\trender: ({ dt_range_time }) => dt_range_time ? dt_range_time[0] : '',\r\n\t\t}, {\r\n\t\t\ttitle: 'Waktu Berakhir',\r\n\t\t\tdata: null,\r\n\t\t\trender: ({ dt_range_time }) => dt_range_time ? dt_range_time[1] : '',\r\n\t\t}, {\r\n\t\t\ttitle: 'Catatan',\r\n\t\t\tdata: 'NotesQuestionTitle',\r\n\t\t}],\r\n\t});\r\n\t$('#table_filter').html('<div class=\"d-inline-flex align-items-center\"><div class=\"mr-2\"><i class=\"fas fa-user\"></i></div><div><select id=\"table-filter-employee\" class=\"selectpicker\" data-style=\"btn-light btn-sm\"></select></div></div>');\r\n\t$$.tblFilter = $('#table-filter-employee').change(function () { $tbl.draw() });\r\n\r\n\t$.fn.dataTable.ext.search.push(function (settings, data, dataIndex) {\r\n\t\treturn (!$$.tblFilter.val() || data[1].includes(`[id=${$$.tblFilter.val()}]`)) && (display || data[3]);\r\n\t});\r\n\r\n\tconst exportExcel = sheets => {\r\n\t\tconst sanitizeName = name => {\r\n\t\t\tif (name.length > 30) name = name.substr(0, 27) + '...';\r\n\t\t\treturn name.replace(/\\\\|\\/|\\?|\\*|\\[|\\]/g, '_');\r\n\t\t}\r\n\t\tlet wb = XLSX.utils.book_new();\r\n\t\tsheets.forEach(a => { XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(a.data), sanitizeName(a.name)) });\r\n\t\tXLSX.writeFile(wb, `Presensi Kaizala (${$('#select-timezone :selected').text()}) - ${moment.utc().add(timezone, 'hours').format('YYYYMMDD-HHmmss')}.xlsx`);\r\n\t}\r\n\r\n\t$('#btn-export').click(function () {\r\n\r\n\t\tlet rawdata = $tbl.rows().data().toArray(),\r\n\t\t\theader,\r\n\t\t\tdata,\r\n\t\t\tdataByEmployee = [];\r\n\r\n\t\tif (display) {\r\n\t\t\theader = ['Hari', 'Tanggal', 'Nama', 'Waktu', 'Koordinat', 'Lokasi', 'Catatan', 'Foto'];\r\n\t\t\tdata = rawdata.map(a => [\r\n\t\t\t\ta.day[0],\r\n\t\t\t\ta.day[1],\r\n\t\t\t\ta['Responder Name'],\r\n\t\t\t\ta.time[0],\r\n\t\t\t\ta['Responder Location Latitude'] + ', ' + a['Responder Location Longitude'],\r\n\t\t\t\ta['Responder Location Location'],\r\n\t\t\t\ta.NotesQuestionTitle,\r\n\t\t\t\ta.PhotoQuestionTitle,\r\n\t\t\t]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\theader = ['Hari', 'Tanggal', 'Nama', 'Waktu Mulai', 'Waktu Berakhir', 'Koordinat Waktu Mulai', 'Koordinat Waktu Berakhir', 'Lokasi Waktu Mulai', 'Lokasi Waktu Berakhir', 'Catatan Waktu Mulai', 'Catatan Waktu Berakhir', 'Foto Waktu Mulai', 'Foto Waktu Berakhir'];\r\n\t\t\tdata = rawdata.filter(a => a.range_time).map(a => [\r\n\t\t\t\ta.day[0],\r\n\t\t\t\ta.day[1],\r\n\t\t\t\ta['Responder Name'],\r\n\t\t\t\ta.range_time[0],\r\n\t\t\t\ta.range_time[1],\r\n\t\t\t\ta.range_coordinate[0],\r\n\t\t\t\ta.range_coordinate[1],\r\n\t\t\t\ta.range_location[0],\r\n\t\t\t\ta.range_location[1],\r\n\t\t\t\ta.range_note[0],\r\n\t\t\t\ta.range_note[1],\r\n\t\t\t\ta.range_photo[0],\r\n\t\t\t\ta.range_photo[1],\r\n\t\t\t]);\r\n\t\t}\r\n\r\n\t\temployees.sort().forEach(name => {\r\n\t\t\tdataByEmployee.push({ name, data: [header].concat(data.filter(a => a[2] === name)) });\r\n\t\t});\r\n\r\n\t\tlet sheets = [{ name: 'Semua Pegawai', data: [header].concat(data) }].concat(dataByEmployee);\r\n\t\texportExcel(sheets);\r\n\r\n\t});\r\n\r\n\t$(document).on('click', '[data-toggle=\"lightbox\"]', function (e) {\r\n\t\te.preventDefault();\r\n\t\t$(this).ekkoLightbox();\r\n\t});\r\n\r\n});\r\n"]}