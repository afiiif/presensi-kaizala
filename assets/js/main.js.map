{"version":3,"sources":["utilities.js","libraries.js","main.js"],"names":["utils","$modal","root","$","dialog","title","btn","closeBtn","body","footer","data","action","show","shown","hidden","loading","a","arguments","length","undefined","unsetError","html","prop","error","unsetLoadingState","hide","concat","slideDown","modal","on","e","tooltip","fn","selectpicker","find","scrollbar","_ref","_ref$title","_ref$btnLabel","btnLabel","_ref$btnClass","btnClass","_ref$btnDisabled","btnDisabled","_ref$btnCloseLabel","btnCloseLabel","_ref$btnCloseClass","btnCloseClass","_ref$data","_ref$dialogClass","dialogClass","_ref$backdrop","backdrop","_ref$action","_ref$show","_ref$shown","_ref$hidden","onclick","attr","addClass","_config","trigger","getModalData","doModalAction","modalLoading","modalError","notif","message","type","settings","options","notifyClose","icon","notify","_objectSpread","getSlug","text","toLowerCase","replace","dbg","c","DEV","console","info","log","split","selector","notifyDefaults","placement","from","animate","enter","exit","extend","dataTable","defaults","dom","language","decimal","thousands","lengthMenu","search","infoFiltered","infoEmpty","paginate","previous","next","zeroRecords","emptyTable","pageLength","document","preventDefault","this","ekkoLightbox","$el","sectionInput","sectionResult","stopPropagation","dropzone","removeClass","readFile","originalEvent","dataTransfer","files","display","Number","val","change","target","click","checkIfDone","n","i","nValid","generateResult","nInvalid","nFailed","readCsv","filename","startsWith","push","csv","toObjects","err","ext","file","name","substr","lastIndexOf","JSZip","loadAsync","then","zip","innerFiles","Object","keys","resetDisplay","timezone","forEach","b","m","moment","add","day","format","id_employee_d","id_employee","id_employee_t","merged","time","allTime","filter","sort","findIndex","range_time","range_coordinate","range_note","NotesQuestionTitle","range_photo","PhotoQuestionTitle","dt_range_time","dt_time","$tbl","tbl","DataTable","render","_ref2","exportExcel","sheets","wb","XLSX","book_new","book_append_sheet","aoa_to_sheet","writeFile","utc","dataByEmployee","header","rawdata","map","employees","reader"],"mappings":"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","file":"main.js","sourcesContent":["const utils = (function() {\r\n\r\n\tlet $modal = {\r\n\t\troot: $('#modal'),\r\n\t\tdialog: $('#modal-dialog'),\r\n\t\ttitle: $('#modal-title'),\r\n\t\tbtn: '',\r\n\t\tcloseBtn: $('#modal-title + .close'),\r\n\t\tbody: $('#modal-body'),\r\n\t\tfooter: $('#modal-footer'),\r\n\t\tdata: {},\r\n\t\taction: () => {},\r\n\t\tshow: () => {},\r\n\t\tshown: () => {},\r\n\t\thidden: () => {},\r\n\t\tloading: (a='<i class=\"fas fa-sync fa-spin mr-2\"></i>Memproses...', unsetError=true) => {\r\n\t\t\tif (a === false) {\r\n\t\t\t\t$('#modal-btn').html($modal.btn).prop('disabled', false);\r\n\t\t\t\t$('[data-dismiss=\"modal\"]').prop('disabled', false);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$('#modal-btn').html(a).prop('disabled', true);\r\n\t\t\t\t$('[data-dismiss=\"modal\"]').prop('disabled', true);\r\n\t\t\t\tif (unsetError) $modal.error(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\terror: (a=false, unsetLoadingState=true) => {\r\n\t\t\tif (a === false) $('#modal-error').hide();\r\n\t\t\telse {\r\n\t\t\t\t$('#modal-error').html(`<div class=\"px-3 py-2\"><i class=\"fas fa-exclamation-triangle mr-2\"></i>${a}</div>`).slideDown();\r\n\t\t\t\tif (unsetLoadingState) $modal.loading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n\r\n\tconst modal = ({ title='', body, btnLabel='Ok', btnClass='btn-primary', btnDisabled=false, btnCloseLabel='Batal', btnCloseClass='btn-default', data={}, dialogClass='', backdrop=true, action=null, show=null, shown=null, hidden=null }) => {\r\n\r\n\t\t$modal.data = data;\r\n\t\t$modal.btn = btnLabel;\r\n\t\t$modal.action = typeof action === 'function' ? action : (() => {});\r\n\t\t$modal.show = typeof show === 'function' ? show : (() => {});\r\n\t\t$modal.shown = typeof shown === 'function' ? shown : (() => {});\r\n\t\t$modal.hidden = typeof hidden === 'function' ? hidden : (() => {});\r\n\r\n\t\tlet onclick = 'data-dismiss=\"modal\"';\r\n\t\tif (typeof action === 'string') onclick = `onclick=\"${action}\"`;\r\n\t\telse if (typeof action === 'function') onclick = 'onclick=\"utils.doModalAction()\"';\r\n\r\n\t\t$modal.dialog.attr('class', 'modal-dialog').addClass(dialogClass);\r\n\t\t$modal.title.html(title);\r\n\t\t$modal.body.html(body);\r\n\t\t$modal.footer.html(`\r\n\t\t\t<button type=\"button\" class=\"btn ${btnCloseClass}\" data-dismiss=\"modal\">${btnCloseLabel}</button>\r\n\t\t\t<button type=\"button\" id=\"modal-btn\" ${onclick} class=\"btn ${btnClass}\" ${btnDisabled ? 'disabled' : ''}>${btnLabel}</button>\r\n\t\t`);\r\n\r\n\t\t$modal.root.data('bs.modal')._config.backdrop = backdrop;\r\n\r\n\t\t$modal.error();\r\n\r\n\t\treturn $modal.root.modal('show').trigger('show.bs.modal');\r\n\t};\r\n\r\n\t$modal.root\r\n\t.modal('hide')\r\n\t.on('show.bs.modal', e => {\r\n\t\t$modal.closeBtn.prop('disabled', false);\r\n\t\t$('[data-toggle=\"tooltip\"]').tooltip('hide');\r\n\t\tif ($.fn.selectpicker) $modal.root.find('.selectpicker').selectpicker('render');\r\n\t\tif ($.fn.scrollbar) $modal.root.find('.scrollbar-outer').scrollbar();\r\n\t\t$modal.show();\r\n\t})\r\n\t.on('shown.bs.modal', e => {\r\n\t\t$modal.shown();\r\n\t})\r\n\t.on('hidden.bs.modal', e => {\r\n\t\t$modal.hidden();\r\n\t});\r\n\r\n\tconst notif = (message, type='info', close=false, settings, options) => {\r\n\t\tif (close) $.notifyClose();\r\n\t\tlet icon = 'icon-info';\r\n\t\tif (type === 'wait') { icon = 'icon-hourglass'; type = 'info'; }\r\n\t\tif (type === 'success') { icon = 'icon-check'; }\r\n\t\tif (type === 'danger' || type === 'warning') { icon = 'icon-exclamation'; }\r\n\t\t$.notify({ message, icon, ...options }, { type, ...settings });\r\n\t}\r\n\r\n\tconst getSlug = text=> text.toLowerCase().replace(/[^\\w ]+/g,'').replace(/ +/g,'-');\r\n\r\n\treturn {\r\n\t\tmodal,\r\n\t\tgetModalData: () => $modal.data,\r\n\t\tdoModalAction: () => $modal.action(),\r\n\t\tmodalLoading: $modal.loading,\r\n\t\tmodalError: $modal.error,\r\n\t\tnotif,\r\n\t\tgetSlug,\r\n\t}\r\n\r\n})();\r\n\r\n\r\n\r\nconst dbg = (a='!', c=0) => {\r\n\tif (typeof DEV !== 'undefined') {\r\n\t\tif (DEV) console.info('%c'+a, `color: ${typeof c==='number'? ['#00ff7f', '#6495ed', '#ff0', '#fa8072', '#ffa500', '#f00'][c] : c}`);\r\n\t}\r\n}\r\n\r\n\r\n\r\n$(()=>{\r\n\r\n\tconsole.log('© Muhammad Afifudin, 2020');\r\n\tconsole.log('%cVersion: '+$('script[src*=\"assets/js\"]').prop('src').split('?v=')[1], 'color: #6495ed');\r\n\r\n\t$('body').tooltip({ selector: '[data-toggle=\"tooltip\"]', html: true });\r\n\r\n});\r\n","$.notifyDefaults({\r\n\tplacement: { from: 'bottom' },\r\n\tanimate: { enter: 'animated fadeInUp', exit: 'animated fadeOutDown' },\r\n});\r\n\r\n$.extend(true, $.fn.dataTable.defaults, {\r\n\tdom: \"<'row justify-content-center'<'col-sm-auto'l><'col-sm'f>>r<'table-responsive't><'row justify-content-center align-items-center'<'col-sm-auto'i><'col-sm'p>>\",\r\n\tlanguage: {\r\n\t\tdecimal: ',',\r\n\t\tthousands: '.',\r\n\t\tlengthMenu: 'Menampilkan &nbsp;_MENU_&nbsp; data',\r\n\t\tsearch: 'Cari',\r\n\t\tinfo: 'Halaman _PAGE_ dari _PAGES_',\r\n\t\tinfoFiltered: '',\r\n\t\tinfoEmpty: 'Menampilkan 0 hasil',\r\n\t\tpaginate: { previous: '<i class=\"fas fa-chevron-left\"></i>', next: '<i class=\"fas fa-chevron-right\"></i>' },\r\n\t\tzeroRecords: 'Tidak ada hasil',\r\n\t\temptyTable: 'Tidak ada data',\r\n\t},\r\n\tpageLength: 50,\r\n\tlengthMenu: [10, 25, 50, 100, 250, 500],\r\n});\r\n","$(()=>{\r\n\r\n\t$(document).on('click', '[data-toggle=\"lightbox\"]', function(e) {\r\n\t\te.preventDefault();\r\n\t\t$(this).ekkoLightbox();\r\n\t});\r\n\r\n\tconst $el = {\r\n\t\tsectionInput: $('#section-input'),\r\n\t\tsectionResult: $('#section-result'),\r\n\t\tdropzone: $('#dropzone'),\r\n\t\tdisplay: $('[name=\"display_setting\"]'),\r\n\t\ttbl: $('#table'),\r\n\t};\r\n\tvar $tbl,\r\n\t\tdata = [],\r\n\t\ttimezone = 7,\r\n\t\tdisplay = 0,\r\n\t\temployees,\r\n\t\tsectionResult = false;\r\n\r\n\t$el.dropzone\r\n\t.on('click', function(e) { $('#input-files').trigger('click') })\r\n\t.on('drag dragstart dragend dragover dragenter dragleave drop', function(e) { e.preventDefault(); e.stopPropagation(); })\r\n\t.on('dragover dragenter', function() { $el.dropzone.addClass('dragover') })\r\n\t.on('dragleave dragend drop', function() { $el.dropzone.removeClass('dragover') })\r\n\t.on('drop', function(e) { readFile(e.originalEvent.dataTransfer.files) });\r\n\r\n\t$el.display.change(function() {\r\n\t\tdisplay = Number($(this).val());\r\n\t\t$el.tbl.toggleClass('td3-d-none td6-d-none', display === 0).toggleClass('td4-d-none td5-d-none', display === 1);\r\n\t\t$tbl.draw();\r\n\t});\r\n\r\n\t$('#input-files').change(function(e) { readFile(e.target.files) });\r\n\r\n\t$('#btn-reset').click(function() {\r\n\t\t$('.tooltip').tooltip('hide');\r\n\t\t$el.sectionResult.hide(); sectionResult = false;\r\n\t\t$el.sectionInput.fadeIn();\r\n\t});\r\n\r\n\tconst readFile = files => {\r\n\r\n\t\tdata = [];\r\n\t\tlet i = 0,\r\n\t\t\tn = files.length,\r\n\t\t\tnValid = 0,\r\n\t\t\tnInvalid = 0,\r\n\t\t\tnFailed = 0;\r\n\r\n\t\tconst checkIfDone = () => {\r\n\t\t\tif (n === i) {\r\n\t\t\t\tif (nValid) {\r\n\t\t\t\t\tutils.notif(nValid+' file berhasil diproses', 'success');\r\n\t\t\t\t\tgenerateResult();\r\n\t\t\t\t}\r\n\t\t\t\tif (nInvalid) utils.notif((nValid ? nInvalid+' file' : 'File')+' tidak valid', 'danger');\r\n\t\t\t\tif (nFailed) utils.notif(nFailed+' file gagal terbaca', 'warning');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst readCsv = (filename, text) => {\r\n\t\t\tif (text.replace(/\\\"/g, '').startsWith('Responder Name,Group Name,Responder Location Latitude,Responder Location Longitude')) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdata.push({\r\n\t\t\t\t\t\tfilename: filename,\r\n\t\t\t\t\t\tdata: $.csv.toObjects(text.replace(/\\,\\=\\\"20/g, ',\"20')),\r\n\t\t\t\t\t});\r\n\t\t\t\t\ti++; nValid++; checkIfDone();\r\n\t\t\t\t}\r\n\t\t\t\tcatch(err) {\r\n\t\t\t\t\ti++; nFailed++; checkIfDone();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse { i++; nInvalid++; checkIfDone(); }\r\n\t\t}\r\n\r\n\t\tArray.from(files).forEach(file => {\r\n\t\t\tlet ext = file.name.substr(file.name.lastIndexOf('.')+1).toLowerCase();\r\n\t\t\tif (ext === 'csv') {\r\n\t\t\t\tlet reader = new FileReader();\r\n\t\t\t\treader.readAsText(file);\r\n\t\t\t\treader.onload = function(e) { readCsv(file.name, e.target.result.replace(/\\t/g, ',')); }\r\n\t\t\t\treader.onerror = function() { i++; nFailed++; checkIfDone(); }\r\n\t\t\t}\r\n\t\t\telse if (ext === 'zip') {\r\n\t\t\t\tJSZip.loadAsync(file).then(function(zip) {\r\n\t\t\t\t\tlet innerFiles = Object.keys(zip.files);\r\n\t\t\t\t\ti -= innerFiles.length - 1;\r\n\t\t\t\t\tinnerFiles.forEach(function (filename) {\r\n\t\t\t\t\t\tif (filename.substr(filename.lastIndexOf('.')+1).toLowerCase() === 'csv') {\r\n\t\t\t\t\t\t\tzip.files[filename].async('string').then(function(text) {\r\n\t\t\t\t\t\t\t\treadCsv(filename, text.replace(/\\t/g, ',').replace(/\\ufeff/g, ''));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse { i++; nInvalid++; checkIfDone(); }\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function (e) {\r\n\t\t\t\t\ti++; nFailed++; checkIfDone();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse { i++; nInvalid++; }\r\n\t\t});\r\n\r\n\t\tcheckIfDone();\r\n\t}\r\n\r\n\tconst generateResult = (resetDisplay=true) => {\r\n\r\n\t\tconsole.info(data);\r\n\r\n\t\tconst colorTime = (m, n) => `<span class=\"text-${n <= 73000 || n >= (m.format('e') === '4' ? 163000 : 160000) ? 'green' : 'danger'}\">${m.format('HH:mm:ss')}</span>`;\r\n\r\n\t\ttimezone = Number($('#select-timezone').val());\r\n\r\n\t\tlet merged = []; employees = [];\r\n\r\n\t\tdata.forEach(a => {\r\n\t\t\ta.data.forEach(b => {\r\n\r\n\t\t\t\tlet m = moment(b['Server Receipt Timestamp (UTC)'].substr(0,19)).add(timezone, 'hours'),\r\n\t\t\t\t\tday = m.format('dddd,D MMMM YYYY').split(','),\r\n\t\t\t\t\ttime = [m.format('HH:mm:ss'), Number(m.format('HHmmss'))];\r\n\r\n\t\t\t\tif (!employees.includes(b['Responder Name'])) employees.push(b['Responder Name']);\r\n\r\n\t\t\t\tlet id_employee = employees.findIndex(c => c === b['Responder Name'])+1,\r\n\t\t\t\t\tid_employee_d = id_employee + m.format('-YYYYMMDD'),\r\n\t\t\t\t\tid_employee_t = id_employee + m.format('-YYYYMMDD-HHmmss');\r\n\r\n\t\t\t\tmerged.push({\r\n\t\t\t\t\t...b,\r\n\t\t\t\t\tm,\r\n\t\t\t\t\tday,\r\n\t\t\t\t\ttime,\r\n\t\t\t\t\tdt_day: m.format('[<span class=\"d-none\">]YYYYMMDD[</span>]dddd, D MMMM YYYY'),\r\n\t\t\t\t\tdt_time: colorTime(m, time[1]),\r\n\t\t\t\t\tid_employee,\r\n\t\t\t\t\tid_employee_d,\r\n\t\t\t\t\tid_employee_t,\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tmerged.forEach(a => {\r\n\t\t\tlet allTime = merged.filter(b => b.id_employee_d === a.id_employee_d).sort((a,b) => a.time[1]>b.time[1] ? 1 : -1),\r\n\t\t\t\tn = allTime.length,\r\n\t\t\t\tthisTimeIndex = allTime.findIndex(b => b.time[0] === a.time[0]);\r\n\t\t\tif (thisTimeIndex === 0) {\r\n\t\t\t\tif (n === 1) {\r\n\t\t\t\t\tif (a.time[1] < 120000) {\r\n\t\t\t\t\t\ta.range_time = [a.time[0], '-'];\r\n\t\t\t\t\t\ta.range_coordinate = [a['Responder Location Latitude']+', '+a['Responder Location Longitude'], '-'];\r\n\t\t\t\t\t\ta.range_note = [a.NotesQuestionTitle, '-'];\r\n\t\t\t\t\t\ta.range_photo = [a.PhotoQuestionTitle, '-'];\r\n\t\t\t\t\t\ta.dt_range_time = [a.dt_time, '<span class=\"text-gray\">-</span>'];\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\ta.range_time = ['-', a.time[0]];\r\n\t\t\t\t\t\ta.range_coordinate = ['-', a['Responder Location Latitude']+', '+a['Responder Location Longitude']];\r\n\t\t\t\t\t\ta.range_note = ['-', a.NotesQuestionTitle];\r\n\t\t\t\t\t\ta.range_photo = ['-', a.PhotoQuestionTitle];\r\n\t\t\t\t\t\ta.dt_range_time = ['<span class=\"text-gray\">-</span>', a.dt_time];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet b = allTime[n-1];\r\n\t\t\t\t\ta.range_time = [a.time[0], b.time[0]];\r\n\t\t\t\t\ta.range_coordinate = [a['Responder Location Latitude']+', '+a['Responder Location Longitude'], b['Responder Location Latitude']+', '+b['Responder Location Longitude']];\r\n\t\t\t\t\ta.range_note = [a.NotesQuestionTitle, b.NotesQuestionTitle];\r\n\t\t\t\t\ta.range_photo = [a.PhotoQuestionTitle, b.PhotoQuestionTitle];\r\n\t\t\t\t\ta.dt_range_time = [a.dt_time, b.dt_time];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$tbl.clear().rows.add(merged).draw();\r\n\t\t$el.tblFilter.html(\r\n\t\t\t'<option value=\"\">Semua Pegawai</option><option style=\"border-bottom: 1px solid #eee; font-size: 0; padding: 6px 0 0; margin-bottom: 6px;\" disabled></option>'\r\n\t\t\t+ employees.map((a,i) => [a, `<option value=\"${i+1}\">${a}</option>`]).sort((a,b) => a[0]>b[0] ? 1 : -1).map(a => a[1]).join('')\r\n\t\t).trigger('change').selectpicker('refresh');\r\n\r\n\t\tif (resetDisplay) {\r\n\t\t\t$('#display_setting1').click();\r\n\t\t\t$('#select-timezone-2').selectpicker('val', timezone);\r\n\t\t\t$el.sectionInput.hide();\r\n\t\t\t$el.sectionResult.fadeIn(); sectionResult = true;\r\n\t\t}\r\n\t}\r\n\r\n\t$('#select-timezone-2').change(function() {\r\n\t\tdbg('Changed - '+sectionResult);\r\n\t\tif (sectionResult) {\r\n\t\t\t$('#select-timezone').selectpicker('val', $('#select-timezone-2').val());\r\n\t\t\tgenerateResult(false);\r\n\t\t}\r\n\t});\r\n\r\n\t$tbl = $el.tbl.DataTable({\r\n\t\tdata: [],\r\n\t\tcolumns: [{\r\n\t\t\tclassName: 'fit',\r\n\t\t\ttitle: 'Hari, Tanggal',\r\n\t\t\tdata: 'dt_day',\r\n\t\t},{\r\n\t\t\ttitle: 'Nama',\r\n\t\t\tdata: null,\r\n\t\t\trender: a => `<span class=\"d-none\">[id=${a.id_employee}]</span>${a['Responder Name']}`,\r\n\t\t},{\r\n\t\t\ttitle: 'Waktu',\r\n\t\t\tdata: 'dt_time',\r\n\t\t},{\r\n\t\t\ttitle: 'Waktu Mulai',\r\n\t\t\tdata: null,\r\n\t\t\trender: ({ dt_range_time }) => dt_range_time ? dt_range_time[0] : '',\r\n\t\t},{\r\n\t\t\ttitle: 'Waktu Berakhir',\r\n\t\t\tdata: null,\r\n\t\t\trender: ({ dt_range_time }) => dt_range_time ? dt_range_time[1] : '',\r\n\t\t},{\r\n\t\t\ttitle: 'Catatan',\r\n\t\t\tdata: 'NotesQuestionTitle',\r\n\t\t// },{\r\n\t\t// \tclassName: 'fit pr-2',\r\n\t\t// \ttitle: '',\r\n\t\t// \tdata: null,\r\n\t\t// \tsearchable: false,\r\n\t\t// \tsortable: false,\r\n\t\t// \trender: () => `<i class=\"fas fa-info-circle fa-fw py-1 cur-p fz-16 text-primary\" title=\"Detail\" onclick=\"utils.notif('Coming soon...', 'wait')\"></i>`,\r\n\t\t}],\r\n\t});\r\n\t$('#table_filter').html('<div class=\"d-inline-flex align-items-center\"><div class=\"mr-2\"><i class=\"fas fa-user\"></i></div><div><select id=\"table-filter-employee\" class=\"selectpicker\" data-style=\"btn-light btn-sm\"></select></div></div>');\r\n\t$el.tblFilter = $('#table-filter-employee').change(function() { $tbl.draw() });\r\n\r\n\t$.fn.dataTable.ext.search.push(function(settings, data, dataIndex) {\r\n\t\treturn ( !$el.tblFilter.val() || data[1].includes(`[id=${$el.tblFilter.val()}]`) ) && ( display || data[3] );\r\n\t});\r\n\r\n\tconst exportExcel = sheets => {\r\n\t\tconst sanitizeName = name => {\r\n\t\t\tif (name.length > 30) name = name.substr(0,27)+'...';\r\n\t\t\treturn name.replace(/\\\\|\\/|\\?|\\*|\\[|\\]/g, '_');\r\n\t\t}\r\n\t\tlet wb = XLSX.utils.book_new();\r\n\t\tsheets.forEach(a => { XLSX.utils.book_append_sheet(wb, XLSX.utils.aoa_to_sheet(a.data), sanitizeName(a.name)) });\r\n\t\tXLSX.writeFile(wb, `Presensi Kaizala (${$('#select-timezone :selected').text()}) - ${moment.utc().add(timezone, 'hours').format('YYYYMMDD-HHmmss')}.xlsx`);\r\n\t}\r\n\r\n\t$('#btn-export').click(function() {\r\n\r\n\t\tlet rawdata = $tbl.rows().data().toArray(),\r\n\t\t\theader,\r\n\t\t\tdata,\r\n\t\t\tdataByEmployee = [];\r\n\r\n\t\tif (display) {\r\n\t\t\theader = ['Hari', 'Tanggal', 'Nama', 'Waktu', 'Koordinat', 'Catatan', 'Foto'];\r\n\t\t\tdata = rawdata.map(a => [\r\n\t\t\t\ta.day[0],\r\n\t\t\t\ta.day[1],\r\n\t\t\t\ta['Responder Name'],\r\n\t\t\t\ta.time,\r\n\t\t\t\ta['Responder Location Latitude']+', '+a['Responder Location Longitude'],\r\n\t\t\t\ta.NotesQuestionTitle,\r\n\t\t\t\ta.PhotoQuestionTitle,\r\n\t\t\t]);\r\n\t\t}\r\n\t\telse {\r\n\t\t\theader = ['Hari', 'Tanggal', 'Nama', 'Waktu Mulai', 'Waktu Berakhir', 'Koordinat Waktu Mulai', 'Koordinat Waktu Berakhir', 'Catatan Waktu Mulai', 'Catatan Waktu Berakhir', 'Foto Waktu Mulai', 'Foto Waktu Berakhir'];\r\n\t\t\tdata = rawdata.filter(a => a.range_time).map(a => [\r\n\t\t\t\ta.day[0],\r\n\t\t\t\ta.day[1],\r\n\t\t\t\ta['Responder Name'],\r\n\t\t\t\ta.range_time[0],\r\n\t\t\t\ta.range_time[1],\r\n\t\t\t\ta.range_coordinate[0],\r\n\t\t\t\ta.range_coordinate[1],\r\n\t\t\t\ta.range_note[0],\r\n\t\t\t\ta.range_note[1],\r\n\t\t\t\ta.range_photo[0],\r\n\t\t\t\ta.range_photo[1],\r\n\t\t\t]);\r\n\t\t}\r\n\r\n\t\temployees.sort().forEach(name => {\r\n\t\t\tdataByEmployee.push({ name, data: [header].concat(data.filter(a => a[2] === name)) });\r\n\t\t});\r\n\r\n\t\tlet sheets = [{ name: 'Semua Pegawai', data: [header].concat(data) }].concat(dataByEmployee);\r\n\t\texportExcel(sheets);\r\n\r\n\t});\r\n\r\n});\r\n"]}