"use strict";function ownKeys(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)}return o}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(o),!0).forEach(function(e){_defineProperty(t,e,o[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))})}return t}function _defineProperty(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var utils=function(){var t={root:$("#modal"),dialog:$("#modal-dialog"),title:$("#modal-title"),btn:"",closeBtn:$("#modal-title + .close"),body:$("#modal-body"),footer:$("#modal-footer"),data:{},action:function(){},show:function(){},shown:function(){},hidden:function(){},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'<i class="fas fa-sync fa-spin mr-2"></i>Memproses...',o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!1===e?($("#modal-btn").html(t.btn).prop("disabled",!1),$('[data-dismiss="modal"]').prop("disabled",!1)):($("#modal-btn").html(e).prop("disabled",!0),$('[data-dismiss="modal"]').prop("disabled",!0),o&&t.error(!1))},error:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!1===e?$("#modal-error").hide():($("#modal-error").html('<div class="px-3 py-2"><i class="fas fa-exclamation-triangle mr-2"></i>'.concat(e,"</div>")).slideDown(),o&&t.loading(!1))}},e=function(e){var o=e.title,n=void 0===o?"":o,a=e.body,i=e.btnLabel,r=void 0===i?"Ok":i,d=e.btnClass,l=void 0===d?"btn-primary":d,s=e.btnDisabled,c=void 0!==s&&s,u=e.btnCloseLabel,f=void 0===u?"Batal":u,m=e.btnCloseClass,p=void 0===m?"btn-default":m,g=e.data,b=void 0===g?{}:g,h=e.dialogClass,v=void 0===h?"":h,_=e.backdrop,y=void 0===_||_,$=e.action,w=void 0===$?null:$,k=e.show,L=void 0===k?null:k,M=e.shown,R=void 0===M?null:M,T=e.hidden,Y=void 0===T?null:T;t.data=b,t.btn=r,t.action="function"==typeof w?w:function(){},t.show="function"==typeof L?L:function(){},t.shown="function"==typeof R?R:function(){},t.hidden="function"==typeof Y?Y:function(){};var x='data-dismiss="modal"';return"string"==typeof w?x='onclick="'.concat(w,'"'):"function"==typeof w&&(x='onclick="utils.doModalAction()"'),t.dialog.attr("class","modal-dialog").addClass(v),t.title.html(n),t.body.html(a),t.footer.html('\n\t\t\t<button type="button" class="btn '.concat(p,'" data-dismiss="modal">').concat(f,'</button>\n\t\t\t<button type="button" id="modal-btn" ').concat(x,' class="btn ').concat(l,'" ').concat(c?"disabled":"",">").concat(r,"</button>\n\t\t")),t.root.data("bs.modal")._config.backdrop=y,t.error(),t.root.modal("show").trigger("show.bs.modal")};t.root.modal("hide").on("show.bs.modal",function(e){t.closeBtn.prop("disabled",!1),$('[data-toggle="tooltip"]').tooltip("hide"),$.fn.selectpicker&&t.root.find(".selectpicker").selectpicker("render"),$.fn.scrollbar&&t.root.find(".scrollbar-outer").scrollbar(),t.show()}).on("shown.bs.modal",function(e){t.shown()}).on("hidden.bs.modal",function(e){t.hidden()});var o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;o&&$.notifyClose();var i="icon-info";"wait"===e&&(i="icon-hourglass",e="info"),"success"===e&&(i="icon-check"),"danger"!==e&&"warning"!==e||(i="icon-exclamation"),$.notify(_objectSpread({message:t,icon:i},a),_objectSpread({type:e},n))},n=function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")};return{modal:e,getModalData:function(){return t.data},doModalAction:function(){return t.action()},modalLoading:t.loading,modalError:t.error,notif:o,getSlug:n}}(),dbg=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"!",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"undefined"!=typeof DEV&&DEV&&console.info("%c"+t,"color: ".concat("number"==typeof e?["#00ff7f","#6495ed","#ff0","#fa8072","#ffa500","#f00"][e]:e))};$(function(){console.log("Â© Muhammad Afifudin, 2020"),console.log("%cVersion: "+$('script[src*="assets/js"]').prop("src").split("?v=")[1],"color: #6495ed"),$("body").tooltip({selector:'[data-toggle="tooltip"]',html:!0})}),$.notifyDefaults({placement:{from:"bottom"},animate:{enter:"animated fadeInUp",exit:"animated fadeOutDown"}}),$.extend(!0,$.fn.dataTable.defaults,{dom:"<'row justify-content-center'<'col-sm-auto'l><'col-sm'f>>r<'table-responsive't><'row justify-content-center align-items-center'<'col-sm-auto'i><'col-sm'p>>",language:{decimal:",",thousands:".",lengthMenu:"Menampilkan &nbsp;_MENU_&nbsp; data",search:"Cari",info:"Halaman _PAGE_ dari _PAGES_",infoFiltered:"",infoEmpty:"Menampilkan 0 hasil",paginate:{previous:'<i class="fas fa-chevron-left"></i>',next:'<i class="fas fa-chevron-right"></i>'},zeroRecords:"Tidak ada hasil",emptyTable:"Tidak ada data"},pageLength:50,lengthMenu:[10,25,50,100,250,500]}),$(function(){var t,e,o={sectionInput:$("#section-input"),sectionResult:$("#section-result"),dropzone:$("#dropzone"),timezone:$("#timezone"),display:$('[name="display_setting"]'),tbl:$("#table")},n=7,a=0;o.dropzone.on("click",function(t){$("#input-files").trigger("click")}).on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){o.dropzone.addClass("dragover")}).on("dragleave dragend drop",function(){o.dropzone.removeClass("dragover")}).on("drop",function(t){i(t.originalEvent.dataTransfer.files)}),o.display.change(function(){a=Number($(this).val()),o.tbl.toggleClass("td3-d-none td6-d-none",0===a).toggleClass("td4-d-none td5-d-none",1===a),t.draw()}),$("#input-files").change(function(t){i(t.target.files)}),$("#btn-reset").click(function(){$(".tooltip").tooltip("hide"),o.sectionResult.hide(),o.sectionInput.fadeIn()});var i=function(t){var e=0,o=t.length,n=0,a=0,i=0,d=[],l=function(){o===e&&(n&&(utils.notif(n+" file berhasil diproses","success"),r(d)),a&&utils.notif((n?a+" file":"File")+" tidak valid","danger"),i&&utils.notif(i+" file gagal terbaca","warning"))};Array.from(t).forEach(function(t){if("csv"===t.name.substr(t.name.lastIndexOf(".")+1).toLowerCase()){var o=new FileReader;o.readAsText(t),o.onload=function(o){var i=o.target.result.replace(/\t/g,",");i.replace(/\"/g,"").startsWith("Responder Name,Group Name,Responder Location Latitude,Responder Location Longitude")?(d.push({filename:t.name,data:$.csv.toObjects(i.replace(/\,\=\"20/g,',"20'))}),e++,n++,l()):(e++,a++,l())},o.onerror=function(){e++,i++,l()}}else e++,a++}),l()},r=function(a){console.info(a);var i=function(t,e){return'<span class="text-'.concat(e<=73e3||e>=("4"===t.format("e")?163e3:16e4)?"green":"danger",'">').concat(t.format("HH:mm:ss"),"</span>")};o.timezone.html($("#select-timezone :selected").text()),n=Number($("#select-timezone").val());var r=[];e=[],a.forEach(function(t){t.data.forEach(function(t){var o=moment(t["ResponseTime (UTC)"].substr(0,19)).add(n,"hours"),a=o.format("dddd,D MMMM YYYY").split(","),d=[o.format("HH:mm:ss"),Number(o.format("HHmmss"))];e.includes(t["Responder Name"])||e.push(t["Responder Name"]);var l=e.findIndex(function(e){return e===t["Responder Name"]})+1,s=l+o.format("-YYYYMMDD"),c=l+o.format("-YYYYMMDD-HHmmss");r.push(_objectSpread({},t,{m:o,day:a,time:d,dt_day:o.format('[<span class="d-none">]YYYYMMDD[</span>]dddd, D MMMM YYYY'),dt_time:i(o,d[1]),id_employee:l,id_employee_d:s,id_employee_t:c}))})}),r.forEach(function(t){var e=r.filter(function(e){return e.id_employee_d===t.id_employee_d}),o=e.length;if(0===e.findIndex(function(e){return e.time[0]===t.time[0]}))if(1===o)t.time[1]<12e4?(t.range_time=[t.time[0],"-"],t.range_coordinate=[t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],"-"],t.range_note=[t.NotesQuestionTitle,"-"],t.range_photo=[t.PhotoQuestionTitle,"-"],t.dt_range_time=[t.dt_time,'<span class="text-gray">-</span>']):(t.range_time=["-",t.time[0]],t.range_coordinate=["-",t["Responder Location Latitude"]+", "+t["Responder Location Longitude"]],t.range_note=["-",t.NotesQuestionTitle],t.range_photo=["-",t.PhotoQuestionTitle],t.dt_range_time=['<span class="text-gray">-</span>',t.dt_time]);else{var n=e[o-1];t.range_time=[t.time[0],n.time[0]],t.range_coordinate=[t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],n["Responder Location Latitude"]+", "+n["Responder Location Longitude"]],t.range_note=[t.NotesQuestionTitle,n.NotesQuestionTitle],t.range_photo=[t.PhotoQuestionTitle,n.PhotoQuestionTitle],t.dt_range_time=[t.dt_time,n.dt_time]}}),t.clear().rows.add(r).draw(),o.tblFilter.html('<option value="">Semua Pegawai</option><option style="border-bottom: 1px solid #eee; font-size: 0; padding: 6px 0 0; margin-bottom: 6px;" disabled></option>'+e.map(function(t,e){return[t,'<option value="'.concat(e+1,'">').concat(t,"</option>")]}).sort(function(t,e){return t[0]>e[0]?1:-1}).map(function(t){return t[1]}).join("")).trigger("change").selectpicker("refresh"),$("#display_setting1").click(),o.sectionInput.hide(),o.sectionResult.fadeIn()};t=o.tbl.DataTable({data:[],columns:[{className:"fit",title:"Hari, Tanggal",data:"dt_day"},{title:"Nama",data:null,render:function(t){return'<span class="d-none">[id='.concat(t.id_employee,"]</span>").concat(t["Responder Name"])}},{title:"Waktu",data:"dt_time"},{title:"Waktu Mulai",data:null,render:function(t){var e=t.dt_range_time;return e?e[0]:""}},{title:"Waktu Berakhir",data:null,render:function(t){var e=t.dt_range_time;return e?e[1]:""}},{title:"Catatan",data:"NotesQuestionTitle"}]}),$("#table_filter").html('<div class="d-inline-flex align-items-center"><div class="mr-2"><i class="fas fa-user"></i></div><div><select id="table-filter-employee" class="selectpicker" data-style="btn-light btn-sm"></select></div></div>'),o.tblFilter=$("#table-filter-employee").change(function(){t.draw()}),$.fn.dataTable.ext.search.push(function(t,e,n){return(!o.tblFilter.val()||e[1].includes("[id=".concat(o.tblFilter.val(),"]")))&&(a||e[3])});var d=function(t){var e=XLSX.utils.book_new();t.forEach(function(t){XLSX.utils.book_append_sheet(e,XLSX.utils.aoa_to_sheet(t.data),t.name)}),XLSX.writeFile(e,"Presensi Kaizala (".concat($("#select-timezone :selected").text(),") - ").concat(moment.utc().add(n,"hours").format("YYYYMMDD-HHmmss"),".xlsx"))};$("#btn-export").click(function(){var o,n,i=t.rows().data().toArray(),r=[];a?(o=["Hari","Tanggal","Nama","Waktu","Koordinat","Catatan","Foto"],n=i.map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.time,t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],t.NotesQuestionTitle,t.PhotoQuestionTitle]})):(o=["Hari","Tanggal","Nama","Waktu Mulai","Waktu Berakhir","Koordinat Waktu Mulai","Koordinat Waktu Berakhir","Catatan Waktu Mulai","Catatan Waktu Berakhir","Foto Waktu Mulai","Foto Waktu Berakhir"],n=i.filter(function(t){return t.range_time}).map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.range_time[0],t.range_time[1],t.range_coordinate[0],t.range_coordinate[1],t.range_note[0],t.range_note[1],t.range_photo[0],t.range_photo[1]]})),e.sort().forEach(function(t){r.push({name:t,data:[o].concat(n.filter(function(e){return e[2]===t}))})});var l=[{name:"Semua Pegawai",data:[o].concat(n)}].concat(r);d(l)})});
//# sourceMappingURL=main.js.map
