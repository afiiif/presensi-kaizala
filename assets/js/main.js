"use strict";function ownKeys(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)}return o}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(o),!0).forEach(function(t){_defineProperty(e,t,o[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))})}return e}function _defineProperty(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}var utils=function(){var O={root:$("#modal"),dialog:$("#modal-dialog"),title:$("#modal-title"),btn:"",closeBtn:$("#modal-title + .close"),body:$("#modal-body"),footer:$("#modal-footer"),data:{},action:function(){},show:function(){},shown:function(){},hidden:function(){},loading:function(t,e){var o=0<arguments.length&&void 0!==t?t:'<i class="fas fa-sync fa-spin mr-2"></i>Memproses...',n=!(1<arguments.length&&void 0!==e)||e;!1===o?($("#modal-btn").html(O.btn).prop("disabled",!1),$('[data-dismiss="modal"]').prop("disabled",!1)):($("#modal-btn").html(o).prop("disabled",!0),$('[data-dismiss="modal"]').prop("disabled",!0),n&&O.error(!1))},error:function(t,e){var o=0<arguments.length&&void 0!==t&&t,n=!(1<arguments.length&&void 0!==e)||e;!1===o?$("#modal-error").hide():($("#modal-error").html('<div class="px-3 py-2"><i class="fas fa-exclamation-triangle mr-2"></i>'.concat(o,"</div>")).slideDown(),n&&O.loading(!1))}};O.root.modal("hide").on("show.bs.modal",function(t){O.closeBtn.prop("disabled",!1),$('[data-toggle="tooltip"]').tooltip("hide"),$.fn.selectpicker&&O.root.find(".selectpicker").selectpicker("render"),$.fn.scrollbar&&O.root.find(".scrollbar-outer").scrollbar(),O.show()}).on("shown.bs.modal",function(t){O.shown()}).on("hidden.bs.modal",function(t){O.hidden()});return{modal:function(t){var e=t.title,o=void 0===e?"":e,n=t.body,a=t.btnLabel,i=void 0===a?"Ok":a,r=t.btnClass,l=void 0===r?"btn-primary":r,s=t.btnDisabled,d=void 0!==s&&s,c=t.btnCloseLabel,u=void 0===c?"Batal":c,f=t.btnCloseClass,m=void 0===f?"btn-default":f,p=t.data,g=void 0===p?{}:p,h=t.dialogClass,b=void 0===h?"":h,v=t.backdrop,_=void 0===v||v,y=t.action,k=void 0===y?null:y,$=t.show,L=void 0===$?null:$,w=t.shown,M=void 0===w?null:w,R=t.hidden,x=void 0===R?null:R;O.data=g,O.btn=i,O.action="function"==typeof k?k:function(){},O.show="function"==typeof L?L:function(){},O.shown="function"==typeof M?M:function(){},O.hidden="function"==typeof x?x:function(){};var D='data-dismiss="modal"';return"string"==typeof k?D='onclick="'.concat(k,'"'):"function"==typeof k&&(D='onclick="utils.doModalAction()"'),O.dialog.attr("class","modal-dialog").addClass(b),O.title.html(o),O.body.html(n),O.footer.html('\n\t\t\t<button type="button" class="btn '.concat(m,'" data-dismiss="modal">').concat(u,'</button>\n\t\t\t<button type="button" id="modal-btn" ').concat(D,' class="btn ').concat(l,'" ').concat(d?"disabled":"",">").concat(i,"</button>\n\t\t")),O.root.data("bs.modal")._config.backdrop=_,O.error(),O.root.modal("show").trigger("show.bs.modal")},getModalData:function(){return O.data},doModalAction:function(){return O.action()},modalLoading:O.loading,modalError:O.error,notif:function(t,e,o,n,a){var i=1<arguments.length&&void 0!==e?e:"info",r=3<arguments.length?n:void 0,l=4<arguments.length?a:void 0;2<arguments.length&&void 0!==o&&o&&$.notifyClose();var s="icon-info";"wait"===i&&(s="icon-hourglass",i="info"),"success"===i&&(s="icon-check"),"danger"!==i&&"warning"!==i||(s="icon-exclamation"),$.notify(_objectSpread({message:t,icon:s},l),_objectSpread({type:i},r))},getSlug:function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")}}}(),dbg=function(t,e){var o=0<arguments.length&&void 0!==t?t:"!",n=1<arguments.length&&void 0!==e?e:0;"undefined"!=typeof DEV&&DEV&&console.info("%c"+o,"color: ".concat("number"==typeof n?["#00ff7f","#6495ed","#ff0","#fa8072","#ffa500","#f00"][n]:n))};$(function(){console.log("Â© Muhammad Afifudin, 2020"),console.log("%cVersion: "+$('script[src*="assets/js"]').prop("src").split("?v=")[1],"color: #6495ed"),$("body").tooltip({selector:'[data-toggle="tooltip"]',html:!0})}),$.notifyDefaults({placement:{from:"bottom"},animate:{enter:"animated fadeInUp",exit:"animated fadeOutDown"}}),$.extend(!0,$.fn.dataTable.defaults,{dom:"<'row justify-content-center'<'col-sm-auto'l><'col-sm'f>>r<'table-responsive't><'row justify-content-center align-items-center'<'col-sm-auto'i><'col-sm'p>>",language:{decimal:",",thousands:".",lengthMenu:"Menampilkan &nbsp;_MENU_&nbsp; data",search:"Cari",info:"Halaman _PAGE_ dari _PAGES_",infoFiltered:"",infoEmpty:"Menampilkan 0 hasil",paginate:{previous:'<i class="fas fa-chevron-left"></i>',next:'<i class="fas fa-chevron-right"></i>'},zeroRecords:"Tidak ada hasil",emptyTable:"Tidak ada data"},pageLength:50,lengthMenu:[10,25,50,100,250,500]}),$(function(){var i,c,n={sectionInput:$("#section-input"),sectionResult:$("#section-result"),dropzone:$("#dropzone"),tbl:$("#table")},s=[],u=7,r=0,f=$('[name="time_setting"]:checked').val(),o=!1;n.dropzone.on("click",function(t){$("#input-files").trigger("click")}).on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){n.dropzone.addClass("dragover")}).on("dragleave dragend drop",function(){n.dropzone.removeClass("dragover")}).on("drop",function(t){e(t.originalEvent.dataTransfer.files)}),$("#input-files").change(function(t){e(t.target.files)}),$("#btn-reset").click(function(){$(".tooltip").tooltip("hide"),n.sectionResult.hide(),o=!1,n.sectionInput.fadeIn()});var e=function(t){s=[];function n(){e===i&&(o&&(utils.notif(o+" file berhasil diproses","success"),d()),r&&utils.notif((o?r+" file":"File")+" tidak valid","danger"),l&&utils.notif(l+" file gagal terbaca","warning"))}function a(t,e){if(e.replace(/\"/g,"").startsWith("Responder Name,Group Name,"))try{s.push({filename:t,data:$.csv.toObjects(e.replace(/\,\=\"20/g,',"20'))}),i++,o++,n()}catch(t){i++,l++,n()}else i++,r++,n()}var i=0,e=t.length,o=0,r=0,l=0;Array.from(t).forEach(function(e){var t=e.name.substr(e.name.lastIndexOf(".")+1).toLowerCase();if("csv"===t){var o=new FileReader;o.readAsText(e),o.onload=function(t){a(e.name,t.target.result.replace(/\t/g,","))},o.onerror=function(){i++,l++,n()}}else"zip"===t?JSZip.loadAsync(e).then(function(t){var e=Object.keys(t.files);i-=e.length-1,e.forEach(function(e){"csv"===e.substr(e.lastIndexOf(".")+1).toLowerCase()?t.files[e].async("string").then(function(t){a(e,t.replace(/\t/g,",").replace(/\ufeff/g,""))}):(i++,r++,n())})},function(t){i++,l++,n()}):(i++,r++)}),n()},d=function(t){var e=!(0<arguments.length&&void 0!==t)||t;console.info(s);u=Number($("#select-timezone").val());var d=[];c=[],s.forEach(function(t){t.data.forEach(function(e){var t=moment(e[f].substr(0,19)).add(u,"hours"),o=t.format("dddd,D MMMM YYYY").split(","),n=[t.format("HH:mm:ss"),Number(t.format("HHmmss"))];c.includes(e["Responder Name"])||c.push(e["Responder Name"]);var a,i,r=c.findIndex(function(t){return t===e["Responder Name"]})+1,l=r+t.format("-YYYYMMDD"),s=r+t.format("-YYYYMMDD-HHmmss");d.push(_objectSpread({},e,{m:t,day:o,time:n,dt_day:t.format('[<span class="d-none">]YYYYMMDD[</span>]dddd, D MMMM YYYY'),dt_time:(a=t,'<span class="text-'.concat((i=n[1])<=73e3||i>=("4"===a.format("e")?163e3:16e4)?"green":"danger",'">').concat(a.format("HH:mm:ss"),"</span>")),id_employee:r,id_employee_d:l,id_employee_t:s}))})}),d.forEach(function(e){var t=d.filter(function(t){return t.id_employee_d===e.id_employee_d}).sort(function(t,e){return t.time[1]>e.time[1]?1:-1}),o=t.length;if(0===t.findIndex(function(t){return t.time[0]===e.time[0]}))if(1===o)e.time[1]<12e4?(e.range_time=[e.time[0],"-"],e.range_coordinate=[e["Responder Location Latitude"]+", "+e["Responder Location Longitude"],"-"],e.range_location=[e["Responder Location Location"],"-"],e.range_note=[e.NotesQuestionTitle,"-"],e.range_photo=[e.PhotoQuestionTitle,"-"],e.dt_range_time=[e.dt_time,'<span class="text-gray">-</span>']):(e.range_time=["-",e.time[0]],e.range_coordinate=["-",e["Responder Location Latitude"]+", "+e["Responder Location Longitude"]],e.range_location=["-",e["Responder Location Location"]],e.range_note=["-",e.NotesQuestionTitle],e.range_photo=["-",e.PhotoQuestionTitle],e.dt_range_time=['<span class="text-gray">-</span>',e.dt_time]);else{var n=t[o-1];e.range_time=[e.time[0],n.time[0]],e.range_coordinate=[e["Responder Location Latitude"]+", "+e["Responder Location Longitude"],n["Responder Location Latitude"]+", "+n["Responder Location Longitude"]],e.range_location=[e["Responder Location Location"],n["Responder Location Location"]],e.range_note=[e.NotesQuestionTitle,n.NotesQuestionTitle],e.range_photo=[e.PhotoQuestionTitle,n.PhotoQuestionTitle],e.dt_range_time=[e.dt_time,n.dt_time]}}),i.clear().rows.add(d).draw(),n.tblFilter.html('<option value="">Semua Pegawai</option><option style="border-bottom: 1px solid #eee; font-size: 0; padding: 6px 0 0; margin-bottom: 6px;" disabled></option>'+c.map(function(t,e){return[t,'<option value="'.concat(e+1,'">').concat(t,"</option>")]}).sort(function(t,e){return t[0]>e[0]?1:-1}).map(function(t){return t[1]}).join("")).trigger("change").selectpicker("refresh"),e&&($("#display_setting1").click(),$("#select-timezone-2").selectpicker("val",u),n.sectionInput.hide(),n.sectionResult.fadeIn(),o=!0)};$('[name="display_setting"]').change(function(){r=Number($(this).val()),n.tbl.toggleClass("td3-d-none td6-d-none",0===r).toggleClass("td4-d-none td5-d-none",1===r),i.draw()}),$('[name="time_setting"]').change(function(){f=$(this).val(),d(!1)}),$("#select-timezone-2").change(function(){dbg("Changed - "+o),o&&($("#select-timezone").selectpicker("val",$("#select-timezone-2").val()),d(!1))}),i=n.tbl.DataTable({data:[],columns:[{className:"fit",title:"Hari, Tanggal",data:"dt_day"},{title:"Nama",data:null,render:function(t){return'<span class="d-none">[id='.concat(t.id_employee,"]</span>").concat(t["Responder Name"])}},{title:"Waktu",data:"dt_time"},{title:"Waktu Mulai",data:null,render:function(t){var e=t.dt_range_time;return e?e[0]:""}},{title:"Waktu Berakhir",data:null,render:function(t){var e=t.dt_range_time;return e?e[1]:""}},{title:"Catatan",data:"NotesQuestionTitle"}]}),$("#table_filter").html('<div class="d-inline-flex align-items-center"><div class="mr-2"><i class="fas fa-user"></i></div><div><select id="table-filter-employee" class="selectpicker" data-style="btn-light btn-sm"></select></div></div>'),n.tblFilter=$("#table-filter-employee").change(function(){i.draw()}),$.fn.dataTable.ext.search.push(function(t,e,o){return(!n.tblFilter.val()||e[1].includes("[id=".concat(n.tblFilter.val(),"]")))&&(r||e[3])});function l(t){var o=XLSX.utils.book_new();t.forEach(function(t){var e;XLSX.utils.book_append_sheet(o,XLSX.utils.aoa_to_sheet(t.data),(30<(e=t.name).length&&(e=e.substr(0,27)+"..."),e.replace(/\\|\/|\?|\*|\[|\]/g,"_")))}),XLSX.writeFile(o,"Presensi Kaizala (".concat($("#select-timezone :selected").text(),") - ").concat(moment.utc().add(u,"hours").format("YYYYMMDD-HHmmss"),".xlsx"))}$("#btn-export").click(function(){var t,o,e=i.rows().data().toArray(),n=[];o=r?(t=["Hari","Tanggal","Nama","Waktu","Koordinat","Lokasi","Catatan","Foto"],e.map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.time[0],t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],t["Responder Location Location"],t.NotesQuestionTitle,t.PhotoQuestionTitle]})):(t=["Hari","Tanggal","Nama","Waktu Mulai","Waktu Berakhir","Koordinat Waktu Mulai","Koordinat Waktu Berakhir","Lokasi Waktu Mulai","Lokasi Waktu Berakhir","Catatan Waktu Mulai","Catatan Waktu Berakhir","Foto Waktu Mulai","Foto Waktu Berakhir"],e.filter(function(t){return t.range_time}).map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.range_time[0],t.range_time[1],t.range_coordinate[0],t.range_coordinate[1],t.range_location[0],t.range_location[1],t.range_note[0],t.range_note[1],t.range_photo[0],t.range_photo[1]]})),c.sort().forEach(function(e){n.push({name:e,data:[t].concat(o.filter(function(t){return t[2]===e}))})});var a=[{name:"Semua Pegawai",data:[t].concat(o)}].concat(n);l(a)}),$(document).on("click",'[data-toggle="lightbox"]',function(t){t.preventDefault(),$(this).ekkoLightbox()})});
//# sourceMappingURL=main.js.map
