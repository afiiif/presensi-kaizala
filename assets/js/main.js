"use strict";function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var utils=function(){var T={root:$("#modal"),dialog:$("#modal-dialog"),title:$("#modal-title"),btn:"",closeBtn:$("#modal-title + .close"),body:$("#modal-body"),footer:$("#modal-footer"),data:{},action:function(){},show:function(){},shown:function(){},hidden:function(){},loading:function(t,e){var n=0<arguments.length&&void 0!==t?t:'<i class="fas fa-sync fa-spin mr-2"></i>Memproses...',o=!(1<arguments.length&&void 0!==e)||e;!1===n?($("#modal-btn").html(T.btn).prop("disabled",!1),$('[data-dismiss="modal"]').prop("disabled",!1)):($("#modal-btn").html(n).prop("disabled",!0),$('[data-dismiss="modal"]').prop("disabled",!0),o&&T.error(!1))},error:function(t,e){var n=0<arguments.length&&void 0!==t&&t,o=!(1<arguments.length&&void 0!==e)||e;!1===n?$("#modal-error").hide():($("#modal-error").html('<div class="px-3 py-2"><i class="fas fa-exclamation-triangle mr-2"></i>'.concat(n,"</div>")).slideDown(),o&&T.loading(!1))}};T.root.modal("hide").on("show.bs.modal",function(t){T.closeBtn.prop("disabled",!1),$('[data-toggle="tooltip"]').tooltip("hide"),$.fn.selectpicker&&T.root.find(".selectpicker").selectpicker("render"),$.fn.scrollbar&&T.root.find(".scrollbar-outer").scrollbar(),T.show()}).on("shown.bs.modal",function(t){T.shown()}).on("hidden.bs.modal",function(t){T.hidden()});return{modal:function(t){var e=t.title,n=void 0===e?"":e,o=t.body,a=t.btnLabel,i=void 0===a?"Ok":a,r=t.btnClass,l=void 0===r?"btn-primary":r,d=t.btnDisabled,s=void 0!==d&&d,c=t.btnCloseLabel,u=void 0===c?"Batal":c,f=t.btnCloseClass,p=void 0===f?"btn-default":f,m=t.data,g=void 0===m?{}:m,h=t.dialogClass,b=void 0===h?"":h,v=t.backdrop,y=void 0===v||v,_=t.action,$=void 0===_?null:_,k=t.show,w=void 0===k?null:k,L=t.shown,M=void 0===L?null:L,x=t.hidden,D=void 0===x?null:x;T.data=g,T.btn=i,T.action="function"==typeof $?$:function(){},T.show="function"==typeof w?w:function(){},T.shown="function"==typeof M?M:function(){},T.hidden="function"==typeof D?D:function(){};var O='data-dismiss="modal"';return"string"==typeof $?O='onclick="'.concat($,'"'):"function"==typeof $&&(O='onclick="utils.doModalAction()"'),T.dialog.attr("class","modal-dialog").addClass(b),T.title.html(n),T.body.html(o),T.footer.html('\n\t\t\t<button type="button" class="btn '.concat(p,'" data-dismiss="modal">').concat(u,'</button>\n\t\t\t<button type="button" id="modal-btn" ').concat(O,' class="btn ').concat(l,'" ').concat(s?"disabled":"",">").concat(i,"</button>\n\t\t")),T.root.data("bs.modal")._config.backdrop=y,T.error(),T.root.modal("show").trigger("show.bs.modal")},getModalData:function(){return T.data},doModalAction:function(){return T.action()},modalLoading:T.loading,modalError:T.error,notif:function(t,e,n,o,a){var i=1<arguments.length&&void 0!==e?e:"info",r=3<arguments.length?o:void 0,l=4<arguments.length?a:void 0;2<arguments.length&&void 0!==n&&n&&$.notifyClose();var d="icon-info";"wait"===i&&(d="icon-hourglass",i="info"),"success"===i&&(d="icon-check"),"danger"!==i&&"warning"!==i||(d="icon-exclamation"),$.notify(_objectSpread({message:t,icon:d},l),_objectSpread({type:i},r))},getSlug:function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")}}}(),dbg=function(t,e){var n=0<arguments.length&&void 0!==t?t:"!",o=1<arguments.length&&void 0!==e?e:0;"undefined"!=typeof DEV&&DEV&&console.info("%c"+n,"color: ".concat("number"==typeof o?["#00ff7f","#6495ed","#ff0","#fa8072","#ffa500","#f00"][o]:o))};$(function(){console.log("Â© Muhammad Afifudin, 2020"),console.log("%cVersion: "+$('script[src*="assets/js"]').prop("src").split("?v=")[1],"color: #6495ed"),$("body").tooltip({selector:'[data-toggle="tooltip"]',html:!0})}),$.notifyDefaults({placement:{from:"bottom"},animate:{enter:"animated fadeInUp",exit:"animated fadeOutDown"}}),$.extend(!0,$.fn.dataTable.defaults,{dom:"<'row justify-content-center'<'col-sm-auto'l><'col-sm'f>>r<'table-responsive't><'row justify-content-center align-items-center'<'col-sm-auto'i><'col-sm'p>>",language:{decimal:",",thousands:".",lengthMenu:"Menampilkan &nbsp;_MENU_&nbsp; data",search:"Cari",info:"Halaman _PAGE_ dari _PAGES_",infoFiltered:"",infoEmpty:"Menampilkan 0 hasil",paginate:{previous:'<i class="fas fa-chevron-left"></i>',next:'<i class="fas fa-chevron-right"></i>'},zeroRecords:"Tidak ada hasil",emptyTable:"Tidak ada data"},pageLength:50,lengthMenu:[10,25,50,100,250,500]}),$(function(){$(document).on("click",'[data-toggle="lightbox"]',function(t){t.preventDefault(),$(this).ekkoLightbox()});var i,c,o={sectionInput:$("#section-input"),sectionResult:$("#section-result"),dropzone:$("#dropzone"),display:$('[name="display_setting"]'),tbl:$("#table")},d=[],u=7,r=0,n=!1;o.dropzone.on("click",function(t){$("#input-files").trigger("click")}).on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){o.dropzone.addClass("dragover")}).on("dragleave dragend drop",function(){o.dropzone.removeClass("dragover")}).on("drop",function(t){e(t.originalEvent.dataTransfer.files)}),o.display.change(function(){r=Number($(this).val()),o.tbl.toggleClass("td3-d-none td6-d-none",0===r).toggleClass("td4-d-none td5-d-none",1===r),i.draw()}),$("#input-files").change(function(t){e(t.target.files)}),$("#btn-reset").click(function(){$(".tooltip").tooltip("hide"),o.sectionResult.hide(),n=!1,o.sectionInput.fadeIn()});var e=function(t){d=[];function o(){e===i&&(n&&(utils.notif(n+" file berhasil diproses","success"),s()),r&&utils.notif((n?r+" file":"File")+" tidak valid","danger"),l&&utils.notif(l+" file gagal terbaca","warning"))}function a(t,e){if(e.replace(/\"/g,"").startsWith("Responder Name,Group Name,"))try{d.push({filename:t,data:$.csv.toObjects(e.replace(/\,\=\"20/g,',"20'))}),i++,n++,o()}catch(t){i++,l++,o()}else i++,r++,o()}var i=0,e=t.length,n=0,r=0,l=0;Array.from(t).forEach(function(e){var t=e.name.substr(e.name.lastIndexOf(".")+1).toLowerCase();if("csv"===t){var n=new FileReader;n.readAsText(e),n.onload=function(t){a(e.name,t.target.result.replace(/\t/g,","))},n.onerror=function(){i++,l++,o()}}else"zip"===t?JSZip.loadAsync(e).then(function(t){var e=Object.keys(t.files);i-=e.length-1,e.forEach(function(e){"csv"===e.substr(e.lastIndexOf(".")+1).toLowerCase()?t.files[e].async("string").then(function(t){a(e,t.replace(/\t/g,",").replace(/\ufeff/g,""))}):(i++,r++,o())})},function(t){i++,l++,o()}):(i++,r++)}),o()},s=function(t){var e=!(0<arguments.length&&void 0!==t)||t;console.info(d);u=Number($("#select-timezone").val());var s=[];c=[],d.forEach(function(t){t.data.forEach(function(e){var t=moment(e["Server Receipt Timestamp (UTC)"].substr(0,19)).add(u,"hours"),n=t.format("dddd,D MMMM YYYY").split(","),o=[t.format("HH:mm:ss"),Number(t.format("HHmmss"))];c.includes(e["Responder Name"])||c.push(e["Responder Name"]);var a,i,r=c.findIndex(function(t){return t===e["Responder Name"]})+1,l=r+t.format("-YYYYMMDD"),d=r+t.format("-YYYYMMDD-HHmmss");s.push(_objectSpread({},e,{m:t,day:n,time:o,dt_day:t.format('[<span class="d-none">]YYYYMMDD[</span>]dddd, D MMMM YYYY'),dt_time:(a=t,'<span class="text-'.concat((i=o[1])<=73e3||i>=("4"===a.format("e")?163e3:16e4)?"green":"danger",'">').concat(a.format("HH:mm:ss"),"</span>")),id_employee:r,id_employee_d:l,id_employee_t:d}))})}),s.forEach(function(e){var t=s.filter(function(t){return t.id_employee_d===e.id_employee_d}).sort(function(t,e){return t.time[1]>e.time[1]?1:-1}),n=t.length;if(0===t.findIndex(function(t){return t.time[0]===e.time[0]}))if(1===n)e.time[1]<12e4?(e.range_time=[e.time[0],"-"],e.range_coordinate=[e["Responder Location Latitude"]+", "+e["Responder Location Longitude"],"-"],e.range_note=[e.NotesQuestionTitle,"-"],e.range_photo=[e.PhotoQuestionTitle,"-"],e.dt_range_time=[e.dt_time,'<span class="text-gray">-</span>']):(e.range_time=["-",e.time[0]],e.range_coordinate=["-",e["Responder Location Latitude"]+", "+e["Responder Location Longitude"]],e.range_note=["-",e.NotesQuestionTitle],e.range_photo=["-",e.PhotoQuestionTitle],e.dt_range_time=['<span class="text-gray">-</span>',e.dt_time]);else{var o=t[n-1];e.range_time=[e.time[0],o.time[0]],e.range_coordinate=[e["Responder Location Latitude"]+", "+e["Responder Location Longitude"],o["Responder Location Latitude"]+", "+o["Responder Location Longitude"]],e.range_note=[e.NotesQuestionTitle,o.NotesQuestionTitle],e.range_photo=[e.PhotoQuestionTitle,o.PhotoQuestionTitle],e.dt_range_time=[e.dt_time,o.dt_time]}}),i.clear().rows.add(s).draw(),o.tblFilter.html('<option value="">Semua Pegawai</option><option style="border-bottom: 1px solid #eee; font-size: 0; padding: 6px 0 0; margin-bottom: 6px;" disabled></option>'+c.map(function(t,e){return[t,'<option value="'.concat(e+1,'">').concat(t,"</option>")]}).sort(function(t,e){return t[0]>e[0]?1:-1}).map(function(t){return t[1]}).join("")).trigger("change").selectpicker("refresh"),e&&($("#display_setting1").click(),$("#select-timezone-2").selectpicker("val",u),o.sectionInput.hide(),o.sectionResult.fadeIn(),n=!0)};$("#select-timezone-2").change(function(){dbg("Changed - "+n),n&&($("#select-timezone").selectpicker("val",$("#select-timezone-2").val()),s(!1))}),i=o.tbl.DataTable({data:[],columns:[{className:"fit",title:"Hari, Tanggal",data:"dt_day"},{title:"Nama",data:null,render:function(t){return'<span class="d-none">[id='.concat(t.id_employee,"]</span>").concat(t["Responder Name"])}},{title:"Waktu",data:"dt_time"},{title:"Waktu Mulai",data:null,render:function(t){var e=t.dt_range_time;return e?e[0]:""}},{title:"Waktu Berakhir",data:null,render:function(t){var e=t.dt_range_time;return e?e[1]:""}},{title:"Catatan",data:"NotesQuestionTitle"}]}),$("#table_filter").html('<div class="d-inline-flex align-items-center"><div class="mr-2"><i class="fas fa-user"></i></div><div><select id="table-filter-employee" class="selectpicker" data-style="btn-light btn-sm"></select></div></div>'),o.tblFilter=$("#table-filter-employee").change(function(){i.draw()}),$.fn.dataTable.ext.search.push(function(t,e,n){return(!o.tblFilter.val()||e[1].includes("[id=".concat(o.tblFilter.val(),"]")))&&(r||e[3])});function l(t){var n=XLSX.utils.book_new();t.forEach(function(t){var e;XLSX.utils.book_append_sheet(n,XLSX.utils.aoa_to_sheet(t.data),(30<(e=t.name).length&&(e=e.substr(0,27)+"..."),e.replace(/\\|\/|\?|\*|\[|\]/g,"_")))}),XLSX.writeFile(n,"Presensi Kaizala (".concat($("#select-timezone :selected").text(),") - ").concat(moment.utc().add(u,"hours").format("YYYYMMDD-HHmmss"),".xlsx"))}$("#btn-export").click(function(){var t,n,e=i.rows().data().toArray(),o=[];n=r?(t=["Hari","Tanggal","Nama","Waktu","Koordinat","Catatan","Foto"],e.map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.time,t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],t.NotesQuestionTitle,t.PhotoQuestionTitle]})):(t=["Hari","Tanggal","Nama","Waktu Mulai","Waktu Berakhir","Koordinat Waktu Mulai","Koordinat Waktu Berakhir","Catatan Waktu Mulai","Catatan Waktu Berakhir","Foto Waktu Mulai","Foto Waktu Berakhir"],e.filter(function(t){return t.range_time}).map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.range_time[0],t.range_time[1],t.range_coordinate[0],t.range_coordinate[1],t.range_note[0],t.range_note[1],t.range_photo[0],t.range_photo[1]]})),c.sort().forEach(function(e){o.push({name:e,data:[t].concat(n.filter(function(t){return t[2]===e}))})});var a=[{name:"Semua Pegawai",data:[t].concat(n)}].concat(o);l(a)})});
//# sourceMappingURL=main.js.map
