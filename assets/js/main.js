"use strict";function ownKeys(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var utils=function(){var t={root:$("#modal"),dialog:$("#modal-dialog"),title:$("#modal-title"),btn:"",closeBtn:$("#modal-title + .close"),body:$("#modal-body"),footer:$("#modal-footer"),data:{},action:function(){},show:function(){},shown:function(){},hidden:function(){},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:'<i class="fas fa-sync fa-spin mr-2"></i>Memproses...',n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!1===e?($("#modal-btn").html(t.btn).prop("disabled",!1),$('[data-dismiss="modal"]').prop("disabled",!1)):($("#modal-btn").html(e).prop("disabled",!0),$('[data-dismiss="modal"]').prop("disabled",!0),n&&t.error(!1))},error:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!1===e?$("#modal-error").hide():($("#modal-error").html('<div class="px-3 py-2"><i class="fas fa-exclamation-triangle mr-2"></i>'.concat(e,"</div>")).slideDown(),n&&t.loading(!1))}},e=function(e){var n=e.title,o=void 0===n?"":n,a=e.body,i=e.btnLabel,r=void 0===i?"Ok":i,l=e.btnClass,d=void 0===l?"btn-primary":l,s=e.btnDisabled,c=void 0!==s&&s,u=e.btnCloseLabel,f=void 0===u?"Batal":u,p=e.btnCloseClass,m=void 0===p?"btn-default":p,g=e.data,h=void 0===g?{}:g,b=e.dialogClass,v=void 0===b?"":b,y=e.backdrop,_=void 0===y||y,$=e.action,k=void 0===$?null:$,w=e.show,L=void 0===w?null:w,M=e.shown,x=void 0===M?null:M,R=e.hidden,D=void 0===R?null:R;t.data=h,t.btn=r,t.action="function"==typeof k?k:function(){},t.show="function"==typeof L?L:function(){},t.shown="function"==typeof x?x:function(){},t.hidden="function"==typeof D?D:function(){};var O='data-dismiss="modal"';return"string"==typeof k?O='onclick="'.concat(k,'"'):"function"==typeof k&&(O='onclick="utils.doModalAction()"'),t.dialog.attr("class","modal-dialog").addClass(v),t.title.html(o),t.body.html(a),t.footer.html('\n\t\t\t<button type="button" class="btn '.concat(m,'" data-dismiss="modal">').concat(f,'</button>\n\t\t\t<button type="button" id="modal-btn" ').concat(O,' class="btn ').concat(d,'" ').concat(c?"disabled":"",">").concat(r,"</button>\n\t\t")),t.root.data("bs.modal")._config.backdrop=_,t.error(),t.root.modal("show").trigger("show.bs.modal")};t.root.modal("hide").on("show.bs.modal",function(e){t.closeBtn.prop("disabled",!1),$('[data-toggle="tooltip"]').tooltip("hide"),$.fn.selectpicker&&t.root.find(".selectpicker").selectpicker("render"),$.fn.scrollbar&&t.root.find(".scrollbar-outer").scrollbar(),t.show()}).on("shown.bs.modal",function(e){t.shown()}).on("hidden.bs.modal",function(e){t.hidden()});var n=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;n&&$.notifyClose();var i="icon-info";"wait"===e&&(i="icon-hourglass",e="info"),"success"===e&&(i="icon-check"),"danger"!==e&&"warning"!==e||(i="icon-exclamation"),$.notify(_objectSpread({message:t,icon:i},a),_objectSpread({type:e},o))},o=function(t){return t.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-")};return{modal:e,getModalData:function(){return t.data},doModalAction:function(){return t.action()},modalLoading:t.loading,modalError:t.error,notif:n,getSlug:o}}(),dbg=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"!",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"undefined"!=typeof DEV&&DEV&&console.info("%c"+t,"color: ".concat("number"==typeof e?["#00ff7f","#6495ed","#ff0","#fa8072","#ffa500","#f00"][e]:e))};$(function(){console.log("Â© Muhammad Afifudin, 2020"),console.log("%cVersion: "+$('script[src*="assets/js"]').prop("src").split("?v=")[1],"color: #6495ed"),$("body").tooltip({selector:'[data-toggle="tooltip"]',html:!0})}),$.notifyDefaults({placement:{from:"bottom"},animate:{enter:"animated fadeInUp",exit:"animated fadeOutDown"}}),$.extend(!0,$.fn.dataTable.defaults,{dom:"<'row justify-content-center'<'col-sm-auto'l><'col-sm'f>>r<'table-responsive't><'row justify-content-center align-items-center'<'col-sm-auto'i><'col-sm'p>>",language:{decimal:",",thousands:".",lengthMenu:"Menampilkan &nbsp;_MENU_&nbsp; data",search:"Cari",info:"Halaman _PAGE_ dari _PAGES_",infoFiltered:"",infoEmpty:"Menampilkan 0 hasil",paginate:{previous:'<i class="fas fa-chevron-left"></i>',next:'<i class="fas fa-chevron-right"></i>'},zeroRecords:"Tidak ada hasil",emptyTable:"Tidak ada data"},pageLength:50,lengthMenu:[10,25,50,100,250,500]}),$(function(){$(document).on("click",'[data-toggle="lightbox"]',function(t){t.preventDefault(),$(this).ekkoLightbox()});var t,e,n={sectionInput:$("#section-input"),sectionResult:$("#section-result"),dropzone:$("#dropzone"),display:$('[name="display_setting"]'),tbl:$("#table")},o=[],a=7,i=0,r=!1;n.dropzone.on("click",function(t){$("#input-files").trigger("click")}).on("drag dragstart dragend dragover dragenter dragleave drop",function(t){t.preventDefault(),t.stopPropagation()}).on("dragover dragenter",function(){n.dropzone.addClass("dragover")}).on("dragleave dragend drop",function(){n.dropzone.removeClass("dragover")}).on("drop",function(t){l(t.originalEvent.dataTransfer.files)}),n.display.change(function(){i=Number($(this).val()),n.tbl.toggleClass("td3-d-none td6-d-none",0===i).toggleClass("td4-d-none td5-d-none",1===i),t.draw()}),$("#input-files").change(function(t){l(t.target.files)}),$("#btn-reset").click(function(){$(".tooltip").tooltip("hide"),n.sectionResult.hide(),r=!1,n.sectionInput.fadeIn()});var l=function(t){o=[];var e=0,n=t.length,a=0,i=0,r=0,l=function(){n===e&&(a&&(utils.notif(a+" file berhasil diproses","success"),d()),i&&utils.notif((a?i+" file":"File")+" tidak valid","danger"),r&&utils.notif(r+" file gagal terbaca","warning"))},s=function(t,n){if(n.replace(/\"/g,"").startsWith("Responder Name,Group Name,Responder Location Latitude,Responder Location Longitude"))try{o.push({filename:t,data:$.csv.toObjects(n.replace(/\,\=\"20/g,',"20'))}),e++,a++,l()}catch(t){e++,r++,l()}else e++,i++,l()};Array.from(t).forEach(function(t){var n=t.name.substr(t.name.lastIndexOf(".")+1).toLowerCase();if("csv"===n){var o=new FileReader;o.readAsText(t),o.onload=function(e){s(t.name,e.target.result.replace(/\t/g,","))},o.onerror=function(){e++,r++,l()}}else"zip"===n?JSZip.loadAsync(t).then(function(t){var n=Object.keys(t.files);e-=n.length-1,n.forEach(function(n){"csv"===n.substr(n.lastIndexOf(".")+1).toLowerCase()?t.files[n].async("string").then(function(t){s(n,t.replace(/\t/g,",").replace(/\ufeff/g,""))}):(e++,i++,l())})},function(t){e++,r++,l()}):(e++,i++)}),l()},d=function(){var i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];console.info(o);var l=function(t,e){return'<span class="text-'.concat(e<=73e3||e>=("4"===t.format("e")?163e3:16e4)?"green":"danger",'">').concat(t.format("HH:mm:ss"),"</span>")};a=Number($("#select-timezone").val());var d=[];e=[],o.forEach(function(t){t.data.forEach(function(t){var n=moment(t["ResponseTime (UTC)"].substr(0,19)).add(a,"hours"),o=n.format("dddd,D MMMM YYYY").split(","),i=[n.format("HH:mm:ss"),Number(n.format("HHmmss"))];e.includes(t["Responder Name"])||e.push(t["Responder Name"]);var r=e.findIndex(function(e){return e===t["Responder Name"]})+1,s=r+n.format("-YYYYMMDD"),c=r+n.format("-YYYYMMDD-HHmmss");d.push(_objectSpread({},t,{m:n,day:o,time:i,dt_day:n.format('[<span class="d-none">]YYYYMMDD[</span>]dddd, D MMMM YYYY'),dt_time:l(n,i[1]),id_employee:r,id_employee_d:s,id_employee_t:c}))})}),d.forEach(function(t){var e=d.filter(function(e){return e.id_employee_d===t.id_employee_d}).sort(function(t,e){return t.time[1]>e.time[1]?1:-1}),n=e.length;if(0===e.findIndex(function(e){return e.time[0]===t.time[0]}))if(1===n)t.time[1]<12e4?(t.range_time=[t.time[0],"-"],t.range_coordinate=[t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],"-"],t.range_note=[t.NotesQuestionTitle,"-"],t.range_photo=[t.PhotoQuestionTitle,"-"],t.dt_range_time=[t.dt_time,'<span class="text-gray">-</span>']):(t.range_time=["-",t.time[0]],t.range_coordinate=["-",t["Responder Location Latitude"]+", "+t["Responder Location Longitude"]],t.range_note=["-",t.NotesQuestionTitle],t.range_photo=["-",t.PhotoQuestionTitle],t.dt_range_time=['<span class="text-gray">-</span>',t.dt_time]);else{var o=e[n-1];t.range_time=[t.time[0],o.time[0]],t.range_coordinate=[t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],o["Responder Location Latitude"]+", "+o["Responder Location Longitude"]],t.range_note=[t.NotesQuestionTitle,o.NotesQuestionTitle],t.range_photo=[t.PhotoQuestionTitle,o.PhotoQuestionTitle],t.dt_range_time=[t.dt_time,o.dt_time]}}),t.clear().rows.add(d).draw(),n.tblFilter.html('<option value="">Semua Pegawai</option><option style="border-bottom: 1px solid #eee; font-size: 0; padding: 6px 0 0; margin-bottom: 6px;" disabled></option>'+e.map(function(t,e){return[t,'<option value="'.concat(e+1,'">').concat(t,"</option>")]}).sort(function(t,e){return t[0]>e[0]?1:-1}).map(function(t){return t[1]}).join("")).trigger("change").selectpicker("refresh"),i&&($("#display_setting1").click(),$("#select-timezone-2").selectpicker("val",a),n.sectionInput.hide(),n.sectionResult.fadeIn(),r=!0)};$("#select-timezone-2").change(function(){dbg("Changed - "+r),r&&($("#select-timezone").selectpicker("val",$("#select-timezone-2").val()),d(!1))}),t=n.tbl.DataTable({data:[],columns:[{className:"fit",title:"Hari, Tanggal",data:"dt_day"},{title:"Nama",data:null,render:function(t){return'<span class="d-none">[id='.concat(t.id_employee,"]</span>").concat(t["Responder Name"])}},{title:"Waktu",data:"dt_time"},{title:"Waktu Mulai",data:null,render:function(t){var e=t.dt_range_time;return e?e[0]:""}},{title:"Waktu Berakhir",data:null,render:function(t){var e=t.dt_range_time;return e?e[1]:""}},{title:"Catatan",data:"NotesQuestionTitle"}]}),$("#table_filter").html('<div class="d-inline-flex align-items-center"><div class="mr-2"><i class="fas fa-user"></i></div><div><select id="table-filter-employee" class="selectpicker" data-style="btn-light btn-sm"></select></div></div>'),n.tblFilter=$("#table-filter-employee").change(function(){t.draw()}),$.fn.dataTable.ext.search.push(function(t,e,o){return(!n.tblFilter.val()||e[1].includes("[id=".concat(n.tblFilter.val(),"]")))&&(i||e[3])});var s=function(t){var e=XLSX.utils.book_new();t.forEach(function(t){XLSX.utils.book_append_sheet(e,XLSX.utils.aoa_to_sheet(t.data),t.name)}),XLSX.writeFile(e,"Presensi Kaizala (".concat($("#select-timezone :selected").text(),") - ").concat(moment.utc().add(a,"hours").format("YYYYMMDD-HHmmss"),".xlsx"))};$("#btn-export").click(function(){var n,o,a=t.rows().data().toArray(),r=[];i?(n=["Hari","Tanggal","Nama","Waktu","Koordinat","Catatan","Foto"],o=a.map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.time,t["Responder Location Latitude"]+", "+t["Responder Location Longitude"],t.NotesQuestionTitle,t.PhotoQuestionTitle]})):(n=["Hari","Tanggal","Nama","Waktu Mulai","Waktu Berakhir","Koordinat Waktu Mulai","Koordinat Waktu Berakhir","Catatan Waktu Mulai","Catatan Waktu Berakhir","Foto Waktu Mulai","Foto Waktu Berakhir"],o=a.filter(function(t){return t.range_time}).map(function(t){return[t.day[0],t.day[1],t["Responder Name"],t.range_time[0],t.range_time[1],t.range_coordinate[0],t.range_coordinate[1],t.range_note[0],t.range_note[1],t.range_photo[0],t.range_photo[1]]})),e.sort().forEach(function(t){r.push({name:t,data:[n].concat(o.filter(function(e){return e[2]===t}))})});var l=[{name:"Semua Pegawai",data:[n].concat(o)}].concat(r);s(l)})});
//# sourceMappingURL=main.js.map
